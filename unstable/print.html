<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Colmena (Unstable)</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Colmena (Unstable)</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/zhaofengli/colmena" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <!-- Generated from version 0.5.0-pre (apiVersion=0.5, unstable=True) -->
<h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p><strong>Colmena</strong> is a simple, stateless <a href="https://nixos.org">NixOS</a> deployment tool modeled after <a href="https://github.com/NixOS/nixops">NixOps</a> and <a href="https://github.com/DBCDK/morph">morph</a>, written in Rust.
It's a thin wrapper over Nix commands like <code>nix-instantiate</code> and <code>nix-copy-closure</code>, and supports parallel deployment.</p>
<p>Interested? Get started <a href="./tutorial/index.html">here</a>!</p>
<pre><div class="hljs">$ <b>colmena apply --on @tag-a</b>
[INFO ] Enumerating nodes...
[INFO ] Selected 7 out of 45 hosts.
  (...) ‚úÖ 0s Build successful
  <b>sigma</b> üïó 7s copying path '/nix/store/h6qpk8rwm3dh3zsl1wlj1jharzf8aw9f-unit-haigha-agent.service' to 'ssh://root@sigma.redacted'...
  <b>theta</b> ‚úÖ 7s Activation successful
  <b>gamma</b> üïò 8s Starting...
  <b>alpha</b> ‚úÖ 1s Activation successful
<b>epsilon</b> üïó 7s copying path '/nix/store/fhh4rfixny8b21l6jqzk7nqwxva5k20h-nixos-system-epsilon-20.09pre-git' to 'ssh://root@epsilon.redacted'...
   <b>beta</b> üïó 7s removing obsolete file /boot/kernels/z28ayg10kpnlrz0s2qrb9pzv82lc20s2-initrd-linux-5.4.89-initrd
  <b>kappa</b> ‚úÖ 2s Activation successful
</div></pre>
<!-- UNSTABLE_BEGIN -->
<p>You are currently reading <strong>the unstable version</strong> of the Colmena Manual, built against the tip of <a href="https://github.com/zhaofengli/colmena">the development branch</a>.
Features described here will eventually become a part of <strong>version 0.5</strong>.</p>
<!-- UNSTABLE_END -->
<h2 id="links"><a class="header" href="#links">Links</a></h2>
<ul>
<li><a href="https://github.com/zhaofengli/colmena">GitHub</a></li>
<li><a href="reference/deployment.html">Deployment Options Reference</a></li>
<li><a href="https://matrix.to/#/#colmena:nixos.org">Matrix Chat (#colmena:nixos.org)</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><!-- Generated from version 0.5.0-pre (apiVersion=0.5, unstable=True) -->
<h1 id="tutorial"><a class="header" href="#tutorial">Tutorial</a></h1>
<h2 id="installation"><a class="header" href="#installation">Installation</a></h2>
<!-- UNSTABLE_BEGIN -->
<p>To install the latest development version to the user profile, use the following command:</p>
<pre><code class="language-bash">nix-env -if https://github.com/zhaofengli/colmena/tarball/main
</code></pre>
<p>To install the latest stable version, read <a href="https://colmena.cli.rs/stable">the corresponding Manual</a> for instructions.</p>
<h3 id="unstable-binary-cache"><a class="header" href="#unstable-binary-cache">Unstable Binary Cache</a></h3>
<p>A public binary cache is available at <a href="https://colmena.cachix.org">https://colmena.cachix.org</a>, courtesy of Cachix.
This binary cache contains unstable versions of Colmena built by <a href="https://github.com/zhaofengli/colmena/actions">GitHub Actions</a>.</p>
<!-- UNSTABLE_END -->
<h2 id="basic-configuration"><a class="header" href="#basic-configuration">Basic Configuration</a></h2>
<p><em>If you use Nix Flakes, follow the Flake version <a href="tutorial/flakes.html">here</a>.</em></p>
<p>Colmena should work with your existing NixOps and morph configurations with minimal modification (see <a href="tutorial/migration.html">Migrating from NixOps/morph</a>).</p>
<p>Here is a sample <code>hive.nix</code> with two nodes, with some common configurations applied to both nodes:</p>
<pre><code class="language-nix">{
  meta = {
    # Override to pin the Nixpkgs version (recommended). This option
    # accepts one of the following:
    # - A path to a Nixpkgs checkout
    # - The Nixpkgs lambda (e.g., import &lt;nixpkgs&gt;)
    # - An initialized Nixpkgs attribute set
    nixpkgs = &lt;nixpkgs&gt;;

    # You can also override Nixpkgs by node!
    nodeNixpkgs = {
      node-b = ./another-nixos-checkout;
    };

    # If your Colmena host has nix configured to allow for remote builds
    # (for nix-daemon, your user being included in trusted-users)
    # you can set a machines file that will be passed to the underlying
    # nix-store command during derivation realization as a builders option.
    # For example, if you support multiple orginizations each with their own
    # build machine(s) you can ensure that builds only take place on your
    # local machine and/or the machines specified in this file.
    # machinesFile = ./machines.client-a;
  };

  defaults = { pkgs, ... }: {
    # This module will be imported by all hosts
    environment.systemPackages = with pkgs; [
      vim wget curl
    ];

    # By default, Colmena will replace unknown remote profile
    # (unknown means the profile isn't in the nix store on the
    # host running Colmena) during apply (with the default goal,
    # boot, and switch).
    # If you share a hive with others, or use multiple machines,
    # and are not careful to always commit/push/pull changes
    # you can accidentaly overwrite a remote profile so in those
    # scenarios you might want to change this default to false.
    # deployment.replaceUnknownProfiles = true;
  };

  host-a = { name, nodes, ... }: {
    # The name and nodes parameters are supported in Colmena,
    # allowing you to reference configurations in other nodes.
    networking.hostName = name;
    time.timeZone = nodes.host-b.config.time.timeZone;

    boot.loader.grub.device = "/dev/sda";
    fileSystems."/" = {
      device = "/dev/sda1";
      fsType = "ext4";
    };
  };

  host-b = {
    # Like NixOps and Morph, Colmena will attempt to connect to
    # the remote host using the attribute name by default. You
    # can override it like:
    deployment.targetHost = "host-b.mydomain.tld";

    # It's also possible to override the target SSH port.
    # For further customization, use the SSH_CONFIG_FILE
    # environment variable to specify a ssh_config file.
    deployment.targetPort = 1234;

    # Override the default for this target host
    deployment.replaceUnknownProfiles = false;

    # You can filter hosts by tags with --on @tag-a,@tag-b.
    # In this example, you can deploy to hosts with the "web" tag using:
    #    colmena apply --on @web
    # You can use globs in tag matching as well:
    #    colmena apply --on '@infra-*'
    deployment.tags = [ "web" "infra-lax" ];

    time.timeZone = "America/Los_Angeles";

    boot.loader.grub.device = "/dev/sda";
    fileSystems."/" = {
      device = "/dev/sda1";
      fsType = "ext4";
    };
  };
}
</code></pre>
<p>The full set of <code>deployment</code> options can be found <a href="tutorial/../reference/deployment.html">here</a>.</p>
<p>Now you are ready to use Colmena! To build the configuration:</p>
<pre><code class="language-bash">colmena build
</code></pre>
<p>To build and deploy to all nodes:</p>
<pre><code class="language-bash">colmena apply
</code></pre>
<h2 id="next-steps"><a class="header" href="#next-steps">Next Steps</a></h2>
<ul>
<li>Head to the <a href="tutorial/../features/index.html">Features</a> section to see what else Colmena can do.</li>
<li>Read more about options available in Colmena in the <a href="tutorial/../reference/index.html">Reference</a> section.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><!-- Generated from version 0.5.0-pre (apiVersion=0.5, unstable=True) -->
<h1 id="usage-with-flakes"><a class="header" href="#usage-with-flakes">Usage with Flakes</a></h1>
<h2 id="installation-1"><a class="header" href="#installation-1">Installation</a></h2>
<!-- UNSTABLE_BEGIN -->
<!-- To install the latest stable version, read [the corresponding Manual](https://colmena.cli.rs/stable) for instructions. -->
<p>To quickly try Colmena out, use the following command to enter an ephemeral environment with the latest development version of <code>colmena</code>:</p>
<pre><code class="language-bash">nix shell github:zhaofengli/colmena
</code></pre>
<p>To install Colmena to the user profile, use the following command:</p>
<pre><code class="language-bash">nix-env -if https://github.com/zhaofengli/colmena/tarball/main
</code></pre>
<p>You can also add <code>github:zhaofengli/colmena</code> as an input in your Flake and add the <code>colmena</code> package to your <code>devShell</code>.</p>
<h3 id="unstable-binary-cache-1"><a class="header" href="#unstable-binary-cache-1">Unstable Binary Cache</a></h3>
<p>A public binary cache is available at <a href="https://colmena.cachix.org">https://colmena.cachix.org</a>, courtesy of Cachix.
This binary cache contains unstable versions of Colmena built by <a href="https://github.com/zhaofengli/colmena/actions">GitHub Actions</a>.</p>
<!-- UNSTABLE_END -->
<h2 id="basic-configuration-1"><a class="header" href="#basic-configuration-1">Basic Configuration</a></h2>
<p>Colmena reads the <code>colmenaHive</code> output in your Flake, generated with <code>colmena.lib.makeHive</code>.</p>
<p>Here is a short example:</p>
<pre><code class="language-nix">{
  inputs = {
    nixpkgs.url = "github:NixOS/nixpkgs/nixos-unstable";
    colmena.url = "github:zhaofengli/colmena";
  };
  outputs = { nixpkgs, colmena, ... }: {
    colmenaHive = colmena.lib.makeHive {
      meta = {
        nixpkgs = import nixpkgs {
          system = "x86_64-linux";
          overlays = [];
        };
      };

      host-a = { name, nodes, pkgs, ... }: {
        boot.isContainer = true;
        time.timeZone = nodes.host-b.config.time.timeZone;
      };
      host-b = {
        deployment = {
          targetHost = "somehost.tld";
          targetPort = 1234;
          targetUser = "luser";
        };
        boot.isContainer = true;
        time.timeZone = "America/Los_Angeles";
      };
    };
  };
}
</code></pre>
<p>The full set of <code>deployment</code> options can be found <a href="tutorial/../reference/deployment.html">here</a>.
You can also check out the example in <a href="tutorial/index.html">the main tutorial</a> for some inspiration.</p>
<p>Now you are ready to use Colmena! To build the configuration:</p>
<pre><code class="language-bash">colmena build
</code></pre>
<p>To build and deploy to all nodes:</p>
<pre><code class="language-bash">colmena apply
</code></pre>
<h2 id="migrating-to-direct-flake-evaluation"><a class="header" href="#migrating-to-direct-flake-evaluation">Migrating to Direct Flake Evaluation</a></h2>
<blockquote>
<p>error: flake 'git+file:///path/to/flake' does not provide attribute 'packages.x86_64-linux.colmenaHive', 'legacyPackages.x86_64-linux.colmenaHive' or 'colmenaHive'</p>
</blockquote>
<p>Colmena now uses <code>nix eval</code> to evaluate flakes.
Your flake needs to depend on Colmena itself as an input and expose a new output called <code>colmenaHive</code>:</p>
<pre><code class="language-diff"> {
   inputs = {
+    # ADDED: Colmena input
+    colmena.url = "github:zhaofengli/colmena";

     # ... Rest of configuration ...
   };
   outputs = { self, colmena, ... }: {
+    # ADDED: New colmenaHive output
+    colmenaHive = colmena.lib.makeHive self.outputs.colmena;

     # Your existing colmena output
     colmena = {
       # ... Rest of configuration ...
     };
   };
 }
</code></pre>
<h2 id="using-legacy-flake-evaluation-deprecated"><a class="header" href="#using-legacy-flake-evaluation-deprecated">Using Legacy Flake Evaluation (Deprecated)</a></h2>
<p>By default, Colmena uses <code>nix eval</code> to evaluate your flake.
If you need to use the old evaluation method based on <code>nix-instantiate</code> and <code>builtins.getFlake</code>, add the <code>--legacy-flake-eval</code> flag.
The legacy flake evaluator uses the <code>colmena</code> output and does not work purely on Nix 2.21+.</p>
<h2 id="next-steps-1"><a class="header" href="#next-steps-1">Next Steps</a></h2>
<ul>
<li>Head to the <a href="tutorial/../features/index.html">Features</a> section to see what else Colmena can do.</li>
<li>Read more about options available in Colmena in the <a href="tutorial/../reference/index.html">Reference</a> section.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><!-- Generated from version 0.5.0-pre (apiVersion=0.5, unstable=True) -->
<h1 id="migrating-from-nixopsmorph"><a class="header" href="#migrating-from-nixopsmorph">Migrating from NixOps/morph</a></h1>
<p>Colmena should work with existing NixOps and morph configurations with minimal modification.
That said, there are a few things to look out for:</p>
<h2 id="colmena-deploys-to-existing-nixos-hosts"><a class="header" href="#colmena-deploys-to-existing-nixos-hosts">Colmena deploys to <em>existing</em> NixOS hosts</a></h2>
<p>Unlike NixOps which can be configured to manage the entire lifecycles of NixOS machines (e.g., spinning up AWS EC2 instances), Colmena can only deploy to hosts already running NixOS.</p>
<h2 id="network-vs-meta"><a class="header" href="#network-vs-meta"><code>network</code> vs <code>meta</code></a></h2>
<p>Colmena accepts <a href="tutorial/../reference/meta.html">a set of options</a> to configure the deployment itself as <code>meta</code>.
For NixOps compatibility, it also accepts <code>network</code> as an alias so you don't have to change your existing configuration.</p>
<h2 id="pinning-nixpkgs"><a class="header" href="#pinning-nixpkgs">Pinning Nixpkgs</a></h2>
<p>You can pin the nixpkgs version by setting <code>meta.nixpkgs</code> (or <code>network.nixpkgs</code> if you use the alias).
This is required if you <a href="tutorial/flakes.html">use Flakes</a>.
The options accepts one of the following:</p>
<ul>
<li>Path to a Nixpkgs checkout <em>(not supported in Flakes)</em>
<ul>
<li>Example: <code>./nixpkgs</code></li>
</ul>
</li>
<li>The Nixpkgs lambda returned by importing its <code>default.nix</code> <em>(not supported in Flakes)</em>
<ul>
<li>Example: <code>import ./nixpkgs</code></li>
</ul>
</li>
<li>A fully initialized Nixpkgs attribute set
<ul>
<li>Example: <code>import ./nixpkgs { system = "x86_64-linux"; }</code></li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><!-- Generated from version 0.5.0-pre (apiVersion=0.5, unstable=True) -->
<h1 id="features"><a class="header" href="#features">Features</a></h1>
<p>This section introduces the main features in Colmena:</p>
<ul>
<li><strong><a href="features/tags.html">Node Tagging</a></strong> - Deploying to a subset of tagged nodes</li>
<li><strong><a href="features/apply-local.html">Local Deployment</a></strong> - Deploying to the host running Colmena itself</li>
<li><strong><a href="features/keys.html">Secrets</a></strong> - Deploying sensitive files separate from the main configuration</li>
<li><strong><a href="features/eval.html">Ad Hoc Evaluation</a></strong> - Evaluating a Nix expression with access to your configuration</li>
<li><strong><a href="features/parallelism.html">Parallelism</a></strong> - Controlling how Colmena parallelizes the deployment process</li>
<li><strong><a href="features/remote-builds.html">Remote Builds</a></strong> - Building system profiles on remote machines</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><!-- Generated from version 0.5.0-pre (apiVersion=0.5, unstable=True) -->
<h1 id="node-tagging"><a class="header" href="#node-tagging">Node Tagging</a></h1>
<p>With node tags, you can quickly select a subset of nodes for deployment.
You can specify tags using the <code>deployment.tags</code> option:</p>
<pre><code class="language-nix">{
  alpha = { pkgs, ... }: {
    deployment.tags = [ "web" "infra-lax" ];

    # ... Rest of configuration ...
  };
  beta = { pkgs, ... }: {
    deployment.tags = [ "infra-sfo" ];

    # ... Rest of configuration ...
  };
}
</code></pre>
<p>You can filter hosts by tags or names with <code>--on</code>, which accepts a comma-separated list of node names or @tags.</p>
<p>To select all nodes with <code>web</code>:</p>
<pre><code class="language-console">$ colmena apply --on @web
</code></pre>
<p>Wildcards are supported as well.
To select all nodes with a tag beginning with <code>infra-</code>:</p>
<pre><code class="language-console">$ colmena apply --on '@infra-*'
</code></pre>
<p><em>(Note the quotes around the argument)</em></p>
<div style="break-before: page; page-break-before: always;"></div><!-- Generated from version 0.5.0-pre (apiVersion=0.5, unstable=True) -->
<h1 id="local-deployment"><a class="header" href="#local-deployment">Local Deployment</a></h1>
<p>For some machines, you may still want to stick with the manual <code>nixos-rebuild</code>-type of workflow.
Colmena allows you to build and activate configurations on the host running Colmena itself, provided that:</p>
<ol>
<li>The node must be running NixOS.</li>
<li>The node must have <code>deployment.allowLocalDeployment</code> set to <code>true</code>.</li>
<li>The node's <em>attribute name</em> must match the hostname of the machine.</li>
</ol>
<p>If you invoke <code>apply-local</code> with <code>--sudo</code>, Colmena will attempt to elevate privileges with <code>sudo</code> if it's not run as root.
You may also find it helpful to set <code>deployment.targetHost</code> to <code>null</code> if you don't intend to deploy to the host via SSH.</p>
<p>As an example, the following <code>hive.nix</code> includes a node (<code>laptop</code>) that is meant to be only deployed with <code>apply-local</code>:</p>
<pre><code class="language-nix">{
  meta = {
    nixpkgs = ./deps/nixpkgs-stable;

    # I'd like to use the unstable version of Nixpkgs on
    # my desktop machines.
    nodeNixpkgs = {
      laptop = ./deps/nixpkgs-unstable;
    };
  };

  # This attribute name must match the output of `hostname` on your machine
  laptop = { name, nodes, ... }: {
    networking.hostName = "laptop";

    deployment = {
      # Allow local deployment with `colmena apply-local`
      allowLocalDeployment = true;

      # Disable SSH deployment. This node will be skipped in a
      # normal`colmena apply`.
      targetHost = null;
    };

    # ... Rest of configuration ...
  };

  server-a = { pkgs, ... }: {
    # This node will use the default Nixpkgs checkout specified
    # in `meta.nixpkgs`.

    # ... Rest of configuration ...
  };
}
</code></pre>
<p>On <code>laptop</code>, run <code>colmena apply-local --sudo</code> to activate the configuration.</p>
<div style="break-before: page; page-break-before: always;"></div><!-- Generated from version 0.5.0-pre (apiVersion=0.5, unstable=True) -->
<h1 id="secrets"><a class="header" href="#secrets">Secrets</a></h1>
<p>Colmena allows you to upload secret files that will not be stored in the Nix store to nodes.
It implements a subset of the <code>deployment.keys</code> options supported by NixOps.</p>
<p>For example, to deploy DNS-01 credentials for use with <code>security.acme</code>:</p>
<pre><code class="language-nix">{
  shared-box = {
    security.acme.certs."my-site.tld".credentialsFile = "/run/keys/acme-credentials.secret";
    deployment.keys."acme-credentials.secret" = {
      # Alternatively, `text` (string) or `keyFile` (path to file)
      # may be specified.
      keyCommand = [ "vault" "read" "-field=env" "secret/dns01" ];

      destDir = "/run/keys";       # Default: /run/keys
      user = "acme";               # Default: root
      group = "nginx";             # Default: root
      permissions = "0640";        # Default: 0600

      uploadAt = "pre-activation"; # Default: pre-activation, Alternative: post-activation
    };
    # Rest of configuration...
  };
}
</code></pre>
<p>Take note that if you use the default path (<code>/run/keys</code>), the secret files are only stored in-memory and will not survive reboots.
To upload your secrets without performing a full deployment, use <code>colmena upload-keys</code>.</p>
<h2 id="key-services"><a class="header" href="#key-services">Key Services</a></h2>
<p>For each secret file deployed using <code>deployment.keys</code>, a systemd service with the name of <code>${name}-key.service</code> is created (<code>acme-credentials.secret-key.service</code> for the example above).
This unit is only active when the corresponding file is present, allowing you to set up dependencies for services requiring secret files to function.</p>
<h2 id="key-permissions"><a class="header" href="#key-permissions">Key Permissions</a></h2>
<p>The <code>/run/keys</code> directory is owned by the <code>keys</code> group. If you are using a
systemd service running as a non-root user, you will likely need to add:</p>
<pre><code>SupplementaryGroups = [ "keys" ];
</code></pre>
<p>to your service configuration.</p>
<h2 id="flakes"><a class="header" href="#flakes">Flakes</a></h2>
<p>If you are using flakes, Nix will copy the entire flake (everything tracked by git) into the Nix store during evaluation.
This means that all files as checked out by git are world-readable, including the ones managed by filter-based encryption tools like <code>git-crypt</code>.
To use <code>deployment.keys.&lt;name&gt;.keyFile</code> with flakes without having the secrets copied to the Nix store, a quoted absolute path can be used.</p>
<div style="break-before: page; page-break-before: always;"></div><!-- Generated from version 0.5.0-pre (apiVersion=0.5, unstable=True) -->
<h1 id="ad-hoc-evaluation"><a class="header" href="#ad-hoc-evaluation">Ad Hoc Evaluation</a></h1>
<p>Sometimes you may want to extract values from your Hive configuration for consumption in another program (e.g., <a href="https://github.com/octodns/octodns">OctoDNS</a>).
To do that, create a <code>.nix</code> file with a lambda:</p>
<pre><code class="language-nix">{ nodes, pkgs, lib, ... }:
# Feels like a NixOS module - But you can return any JSON-serializable value
lib.attrsets.mapAttrs (k: v: v.config.deployment.targetHost) nodes
</code></pre>
<p>Then you can obtain a JSON output with:</p>
<pre><code class="language-console">$ colmena eval target-hosts.nix
{"alpha":"fd12:3456::1","beta":"fd12:3456::2"}
</code></pre>
<p>You can also specify an expression directly on the command line:</p>
<pre><code class="language-console">$ colmena eval -E '{ nodes, pkgs, lib, ... }: ...'
</code></pre>
<h2 id="instantiation"><a class="header" href="#instantiation">Instantiation</a></h2>
<p>You may directly instantiate an expression that evaluates to a derivation:</p>
<pre><code class="language-console">$ colmena eval --instantiate -E '{ nodes, ... }: nodes.alpha.config.boot.kernelPackages.kernel'
/nix/store/7ggmhnwvywrqcd1z2sdpan8afz55sw7z-linux-5.14.14.drv
</code></pre>
<h2 id="interactive-repl"><a class="header" href="#interactive-repl">Interactive REPL</a></h2>
<p>To explore the configurations interactively, start a REPL session with <code>colmena repl</code>:</p>
<pre><code class="language-console">$ colmena repl
[INFO ] Using flake: git+file:///home/user/cluster
Welcome to Nix 2.10.3. Type :? for help.

Loading installable ''...
Added 3 variables.
nix-repl&gt; nodes.alpha.config.deployment.targetHost
"fd12:3456::1"
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><!-- Generated from version 0.5.0-pre (apiVersion=0.5, unstable=True) -->
<h1 id="parallelism"><a class="header" href="#parallelism">Parallelism</a></h1>
<p>Colmena is built from the ground up to support parallel deployments.
Evaluation, build, and deployment of node configurations can happen at the same time.</p>
<h2 id="configuration"><a class="header" href="#configuration">Configuration</a></h2>
<p>The parallelism of Colmena can be controlled through two flags:</p>
<p><strong><code>--limit &lt;number&gt;</code></strong></p>
<p>Number of hosts to deploy at once in the final step (pushing closures and activating new profiles). The default value is 10.</p>
<p><strong><code>--eval-node-limit &lt;number&gt;</code></strong></p>
<p>By default, Colmena will automatically determine the maximum number of nodes to evaluate at the same time according to available RAM.
This flag allows you to set the limit to a predetermined value.</p>
<h2 id="parallel-evaluation-experimental"><a class="header" href="#parallel-evaluation-experimental">Parallel Evaluation (Experimental)</a></h2>
<p>By default, Colmena evaluates nodes in batches according to available RAM using Nix's built-in single-threaded evaluator.
Experimental support is available for using <a href="https://github.com/nix-community/nix-eval-jobs">nix-eval-jobs</a> as the evaluator.</p>
<p>When nix-eval-jobs is enabled via <code>--evaluator streaming</code>, evaluation is parallelized with deployment processes kicked off as individual nodes finish evaluating.</p>
<div style="break-before: page; page-break-before: always;"></div><!-- Generated from version 0.5.0-pre (apiVersion=0.5, unstable=True) -->
<h1 id="remote-builds"><a class="header" href="#remote-builds">Remote Builds</a></h1>
<p>If the host running Colmena is not powerful enough, consider offloading the actual builds to remote machines.
Colmena supports two ways to achieve this:</p>
<h2 id="using-colmenas-deploymentbuildontarget"><a class="header" href="#using-colmenas-deploymentbuildontarget">Using Colmena's <code>deployment.buildOnTarget</code></a></h2>
<p>If you set <a href="features/../reference/deployment.html#deploymentbuildontarget"><code>deployment.buildOnTarget = true;</code></a> for a node, then the actual build process will be initiated on the node itself.
Colmena will evaluate the configuration locally before copying the derivations to the target node.
You can temporarily enable this for all nodes by passing <code>--build-on-target</code> on the command line, or disable it with <code>--no-build-on-target</code>.</p>
<p>This is most useful in scenarios where the machine running Colmena is bandwidth-constrained, or it's inconvenient to configure designated builders beforehand.
With this method, the build results will <em>not</em> be copied back to the local machine or otherwise shared across the target nodes.
If you have custom packages used on multiple nodes, the work required to build those packages will be duplicated across the nodes.</p>
<h2 id="using-the-native-distributed-build-feature-in-nix"><a class="header" href="#using-the-native-distributed-build-feature-in-nix">Using the native distributed build feature in Nix</a></h2>
<p>When <a href="https://nixos.org/manual/nix/unstable/advanced-topics/distributed-builds.html">distributed build</a> is enabled, Nix will transparently forward builds to the configured builders.
After the builds are done, Nix will copy the results back to the local machine.</p>
<p>Builders can either be configured globally or in your configuration with <a href="features/../reference/meta.html#machinesFile"><code>meta.machinesFile</code></a>.</p>
<div style="break-before: page; page-break-before: always;"></div><!-- Generated from version 0.5.0-pre (apiVersion=0.5, unstable=True) -->
<h1 id="examples"><a class="header" href="#examples">Examples</a></h1>
<p>This section contains examples of setups people commonly use:</p>
<ul>
<li><strong><a href="examples/multi-arch.html">Multi-Architecture Deployments</a></strong> - Deploying to hosts running a foreign architecture</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><!-- Generated from version 0.5.0-pre (apiVersion=0.5, unstable=True) -->
<h1 id="multi-architecture-deployments"><a class="header" href="#multi-architecture-deployments">Multi-Architecture Deployments</a></h1>
<p>You can deploy to hosts running different architectures with a single configuration.
There are two ways to achieve this:</p>
<h2 id="using-binfmt-emulation"><a class="header" href="#using-binfmt-emulation">Using <code>binfmt</code> Emulation</a></h2>
<p>On Linux hosts, you can run builds through transparent binary emulation using <a href="https://nixos.wiki/wiki/NixOS_on_ARM#Compiling_through_QEMU">QEMU and binfmt-misc</a>.</p>
<p>This following example sets up binfmt, allowing an X86-64 host (<code>laptop</code>) to build derivations for an AArch64 host (<code>rpi</code>) through QEMU:</p>
<pre><code class="language-nix">{
  # The NixOS machine you are running Colmena on (x86_64-linux)
  laptop = { pkgs, ... }: {
    # Enable binfmt emulation for aarch64-linux
    boot.binfmt.emulatedSystems = [ "aarch64-linux" ];

    # ... Rest of configuration ...
  };

  # The remote machine running a foreign architecture (aarch64-linux)
  rpi = { pkgs, ... }: {
    # Override nixpkgs architecture
    nixpkgs.system = "aarch64-linux";

    # ... Rest of configuration ...
  };
}
</code></pre>
<p><em>(For Flake users, the above attribute set is the value of <code>outputs.colmena</code>)</em></p>
<p>First, deploy the local configuration with <code>colmena apply-local --sudo</code>.
For more information on what is required on the local system, see <a href="examples/../features/apply-local.html">Local Deployment</a>.</p>
<p>After the new configuration is activated, binfmt emulation will be set up on the local machine.
You can then deploy to the <code>rpi</code> node with <code>colmena apply --on rpi</code>.</p>
<h2 id="building-remotely"><a class="header" href="#building-remotely">Building Remotely</a></h2>
<p>If the remote nodes are powerful enough, you may also execute builds on them directly.
See <a href="examples/../features/remote-builds.html">Remote Builds</a> for more details.</p>
<div style="break-before: page; page-break-before: always;"></div><!-- Generated from version 0.5.0-pre (apiVersion=0.5, unstable=True) -->
<h1 id="reference"><a class="header" href="#reference">Reference</a></h1>
<!-- UNSTABLE_BEGIN -->
<p>You are currently reading <strong>the unstable version</strong> of the Colmena Manual, built against the tip of <a href="https://github.com/zhaofengli/colmena">the development branch</a>.</p>
<!-- UNSTABLE_END -->
<p>This section contains detailed listings of options and parameters accepted by Colmena:</p>
<ul>
<li><strong><a href="reference/deployment.html">Deployment Options</a></strong></li>
<li><strong><a href="reference/meta.html">Meta Options</a></strong></li>
<li><strong><a href="reference/cli.html">Command Line Arguments</a></strong></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><!-- Generated from version 0.5.0-pre (apiVersion=0.5, unstable=True) -->
<h1 id="deployment-options"><a class="header" href="#deployment-options">Deployment Options</a></h1>
<!-- UNSTABLE_BEGIN -->
<p>You are currently reading <strong>the unstable version</strong> of the Colmena Manual, built against the tip of <a href="https://github.com/zhaofengli/colmena">the development branch</a>.</p>
<!-- UNSTABLE_END -->
<p>Colmena adds a set of extra options that can be used in your NixOS configurations under the <code>deployment</code> prefix.</p>
<!--
    The following is injected by the build system

    Looking to improve the description? Head to `src/nix/hive/eval.nix` in the repo :)
-->
<h2 id="deploymentallowlocaldeployment"><a class="header" href="#deploymentallowlocaldeployment">deployment.allowLocalDeployment</a></h2>
<p>Allow the configuration to be applied locally on the host running
Colmena.</p>
<p>For local deployment to work, all of the following must be true:</p>
<ul>
<li>The node must be running NixOS.</li>
<li>The node must have deployment.allowLocalDeployment set to true.</li>
<li>The node‚Äôs networking.hostName must match the hostname.</li>
</ul>
<p>To apply the configurations locally, run <code>colmena apply-local</code>.
You can also set deployment.targetHost to null if the nost is not
accessible over SSH (only local deployment will be possible).</p>
<p><em>Type:</em>
boolean</p>
<p><em>Default:</em>
<code>false</code></p>
<h2 id="deploymentbuildontarget"><a class="header" href="#deploymentbuildontarget">deployment.buildOnTarget</a></h2>
<p>Whether to build the system profiles on the target node itself.</p>
<p>When enabled, Colmena will copy the derivation to the target
node and initiate the build there. This avoids copying back the
build results involved with the native distributed build
feature. Furthermore, the <code>build</code> goal will be equivalent to
the <code>push</code> goal. Since builds happen on the target node, the
results are automatically ‚Äúpushed‚Äù and won‚Äôt exist in the local
Nix store.</p>
<p>You can temporarily override per-node settings by passing
<code>--build-on-target</code> (enable for all nodes) or
<code>--no-build-on-target</code> (disable for all nodes) on the command
line.</p>
<p><em>Type:</em>
boolean</p>
<p><em>Default:</em>
<code>false</code></p>
<h2 id="deploymentkeys"><a class="header" href="#deploymentkeys">deployment.keys</a></h2>
<p>A set of secrets to be deployed to the node.</p>
<p>Secrets are transferred to the node out-of-band and
never ends up in the Nix store.</p>
<p><em>Type:</em>
attribute set of (submodule)</p>
<p><em>Default:</em>
<code>{ }</code></p>
<h2 id="deploymentkeysnamedestdir"><a class="header" href="#deploymentkeysnamedestdir">deployment.keys.&lt;name&gt;.destDir</a></h2>
<p>Destination directory on the host.</p>
<p><em>Type:</em>
absolute path</p>
<p><em>Default:</em>
<code>"/run/keys"</code></p>
<h2 id="deploymentkeysnamegroup"><a class="header" href="#deploymentkeysnamegroup">deployment.keys.&lt;name&gt;.group</a></h2>
<p>The group that will own the file.</p>
<p><em>Type:</em>
string</p>
<p><em>Default:</em>
<code>"root"</code></p>
<h2 id="deploymentkeysnamekeycommand"><a class="header" href="#deploymentkeysnamekeycommand">deployment.keys.&lt;name&gt;.keyCommand</a></h2>
<p>Command to run to generate the key.
One of <code>text</code>, <code>keyCommand</code> and <code>keyFile</code> must be set.</p>
<p><em>Type:</em>
null or (list of string)</p>
<p><em>Default:</em>
<code>null</code></p>
<h2 id="deploymentkeysnamekeyfile"><a class="header" href="#deploymentkeysnamekeyfile">deployment.keys.&lt;name&gt;.keyFile</a></h2>
<p>Path of the local file to read the key from.
One of <code>text</code>, <code>keyCommand</code> and <code>keyFile</code> must be set.</p>
<p><em>Type:</em>
null or absolute path</p>
<p><em>Default:</em>
<code>null</code></p>
<h2 id="deploymentkeysnamename"><a class="header" href="#deploymentkeysnamename">deployment.keys.&lt;name&gt;.name</a></h2>
<p>File name of the key.</p>
<p><em>Type:</em>
string</p>
<p><em>Default:</em>
<code>"‚Äπname‚Ä∫"</code></p>
<h2 id="deploymentkeysnamepermissions"><a class="header" href="#deploymentkeysnamepermissions">deployment.keys.&lt;name&gt;.permissions</a></h2>
<p>Permissions to set for the file.</p>
<p><em>Type:</em>
string</p>
<p><em>Default:</em>
<code>"0600"</code></p>
<h2 id="deploymentkeysnametext"><a class="header" href="#deploymentkeysnametext">deployment.keys.&lt;name&gt;.text</a></h2>
<p>Content of the key.
One of <code>text</code>, <code>keyCommand</code> and <code>keyFile</code> must be set.</p>
<p><em>Type:</em>
null or string</p>
<p><em>Default:</em>
<code>null</code></p>
<h2 id="deploymentkeysnameuploadat"><a class="header" href="#deploymentkeysnameuploadat">deployment.keys.&lt;name&gt;.uploadAt</a></h2>
<p>When to upload the keys.</p>
<ul>
<li>pre-activation (default): Upload the keys before activating the new system profile.</li>
<li>post-activation: Upload the keys after successfully activating the new system profile.</li>
</ul>
<p>For <code>colmena upload-keys</code>, all keys are uploaded at the same time regardless of the configuration here.</p>
<p><em>Type:</em>
one of ‚Äúpre-activation‚Äù, ‚Äúpost-activation‚Äù</p>
<p><em>Default:</em>
<code>"pre-activation"</code></p>
<h2 id="deploymentkeysnameuser"><a class="header" href="#deploymentkeysnameuser">deployment.keys.&lt;name&gt;.user</a></h2>
<p>The group that will own the file.</p>
<p><em>Type:</em>
string</p>
<p><em>Default:</em>
<code>"root"</code></p>
<h2 id="deploymentprivilegeescalationcommand"><a class="header" href="#deploymentprivilegeescalationcommand">deployment.privilegeEscalationCommand</a></h2>
<p>Command to use to elevate privileges when activating the new profiles on SSH hosts.</p>
<p>This is used on SSH hosts when <code>deployment.targetUser</code> is not <code>root</code>.
The user must be allowed to use the command non-interactively.</p>
<p><em>Type:</em>
list of string</p>
<p><em>Default:</em></p>
<pre><code>[
  "sudo"
  "-H"
  "--"
]
</code></pre>
<h2 id="deploymentreplaceunknownprofiles"><a class="header" href="#deploymentreplaceunknownprofiles">deployment.replaceUnknownProfiles</a></h2>
<p>Allow a configuration to be applied to a host running a profile we
have no knowledge of. By setting this option to false, you reduce
the likelyhood of rolling back changes made via another Colmena user.</p>
<p>Unknown profiles are usually the result of either:</p>
<ul>
<li>The node had a profile applied, locally or by another Colmena.</li>
<li>The host running Colmena garbage-collecting the profile.</li>
</ul>
<p>To force profile replacement on all targeted nodes during apply,
use the flag <code>--force-replace-unknown-profiles</code>.</p>
<p><em>Type:</em>
boolean</p>
<p><em>Default:</em>
<code>true</code></p>
<h2 id="deploymentsshoptions"><a class="header" href="#deploymentsshoptions">deployment.sshOptions</a></h2>
<p>Extra SSH options to pass to the SSH command.</p>
<p><em>Type:</em>
list of string</p>
<p><em>Default:</em>
<code>[ ]</code></p>
<h2 id="deploymenttags"><a class="header" href="#deploymenttags">deployment.tags</a></h2>
<p>A list of tags for the node.</p>
<p>Can be used to select a group of nodes for deployment.</p>
<p><em>Type:</em>
list of string</p>
<p><em>Default:</em>
<code>[ ]</code></p>
<h2 id="deploymenttargethost"><a class="header" href="#deploymenttargethost">deployment.targetHost</a></h2>
<p>The target SSH node for deployment.</p>
<p>By default, the node‚Äôs attribute name will be used.
If set to null, only local deployment will be supported.</p>
<p><em>Type:</em>
null or string</p>
<p><em>Default:</em>
<code>"nixos"</code></p>
<h2 id="deploymenttargetport"><a class="header" href="#deploymenttargetport">deployment.targetPort</a></h2>
<p>The target SSH port for deployment.</p>
<p>By default, the port is the standard port (22) or taken
from your ssh_config.</p>
<p><em>Type:</em>
null or (unsigned integer, meaning &gt;=0)</p>
<p><em>Default:</em>
<code>null</code></p>
<h2 id="deploymenttargetuser"><a class="header" href="#deploymenttargetuser">deployment.targetUser</a></h2>
<p>The user to use to log into the remote node. If set to null, the
target user will not be specified in SSH invocations.</p>
<p><em>Type:</em>
null or string</p>
<p><em>Default:</em>
<code>"root"</code></p>
<div style="break-before: page; page-break-before: always;"></div><!-- Generated from version 0.5.0-pre (apiVersion=0.5, unstable=True) -->
<h1 id="meta-options"><a class="header" href="#meta-options">Meta Options</a></h1>
<!-- UNSTABLE_BEGIN -->
<p>You are currently reading <strong>the unstable version</strong> of the Colmena Manual, built against the tip of <a href="https://github.com/zhaofengli/colmena">the development branch</a>.</p>
<!-- UNSTABLE_END -->
<p>The following is a list of options that can be added to the <code>meta</code> attribute set.</p>
<p>For compatibility with NixOps, you may name it <code>network</code> instead of <code>meta</code>.
However, you cannot specify both at the same time.</p>
<!--
    The following is injected by the build system

    Looking to improve the descriptions? Head to `src/nix/hive/eval.nix` in the repo :)
-->
<h2 id="allowapplyall"><a class="header" href="#allowapplyall">allowApplyAll</a></h2>
<p>Whether to allow deployments without a node filter set.</p>
<p>If set to false, a node filter must be specified with <code>--on</code> when
deploying.</p>
<p>It helps prevent accidental deployments to the entire cluster
when tags are used (e.g., <code>@production</code> and <code>@staging</code>).</p>
<p><em>Type:</em>
boolean</p>
<p><em>Default:</em>
<code>true</code></p>
<h2 id="description"><a class="header" href="#description">description</a></h2>
<p>A short description for the configuration.</p>
<p><em>Type:</em>
string</p>
<p><em>Default:</em>
<code>"A Colmena Hive"</code></p>
<h2 id="machinesfile"><a class="header" href="#machinesfile">machinesFile</a></h2>
<p>Use the machines listed in this file when building this hive configuration.</p>
<p>If your Colmena host has nix configured to allow for remote builds
(for nix-daemon, your user being included in trusted-users)
you can set a machines file that will be passed to the underlying
nix-store command during derivation realization as a builders option.
For example, if you support multiple orginizations each with their own
build machine(s) you can ensure that builds only take place on your
local machine and/or the machines specified in this file.</p>
<p>See https://nixos.org/manual/nix/stable/advanced-topics/distributed-builds
for the machine specification format.</p>
<p>This option is ignored when builds are initiated on the remote nodes
themselves via <code>deployment.buildOnTarget</code> or <code>--build-on-target</code>. To
still use the Nix distributed build functionality, configure the
builders on the target nodes with <code>nix.buildMachines</code>.</p>
<p><em>Type:</em>
null or absolute path</p>
<p><em>Default:</em>
<code>null</code></p>
<h2 id="name"><a class="header" href="#name">name</a></h2>
<p>The name of the configuration.</p>
<p><em>Type:</em>
string</p>
<p><em>Default:</em>
<code>"hive"</code></p>
<h2 id="nixpkgs"><a class="header" href="#nixpkgs">nixpkgs</a></h2>
<p>The pinned Nixpkgs package set. Accepts one of the following:</p>
<ul>
<li>A path to a Nixpkgs checkout</li>
<li>The Nixpkgs lambda (e.g., import &lt;nixpkgs&gt;)</li>
<li>An initialized Nixpkgs attribute set</li>
</ul>
<p>This option must be specified when using Flakes.</p>
<p><em>Type:</em>
unspecified value</p>
<p><em>Default:</em>
<code>null</code></p>
<h2 id="nodenixpkgs"><a class="header" href="#nodenixpkgs">nodeNixpkgs</a></h2>
<p>Node-specific Nixpkgs pins.</p>
<p><em>Type:</em>
attribute set of unspecified value</p>
<p><em>Default:</em>
<code>{ }</code></p>
<h2 id="nodespecialargs"><a class="header" href="#nodespecialargs">nodeSpecialArgs</a></h2>
<p>Node-specific special args.</p>
<p><em>Type:</em>
attribute set of unspecified value</p>
<p><em>Default:</em>
<code>{ }</code></p>
<h2 id="specialargs"><a class="header" href="#specialargs">specialArgs</a></h2>
<p>A set of special arguments to be passed to NixOS modules.</p>
<p>This will be merged into the <code>specialArgs</code> used to evaluate
the NixOS configurations.</p>
<p><em>Type:</em>
attribute set of unspecified value</p>
<p><em>Default:</em>
<code>{ }</code></p>
<div style="break-before: page; page-break-before: always;"></div><!-- Generated from version 0.5.0-pre (apiVersion=0.5, unstable=True) -->
<h1 id="command-line-options"><a class="header" href="#command-line-options">Command Line Options</a></h1>
<!-- UNSTABLE_BEGIN -->
<p>You are currently reading <strong>the unstable version</strong> of the Colmena Manual, built against the tip of <a href="https://github.com/zhaofengli/colmena">the development branch</a>.</p>
<!-- UNSTABLE_END -->
<p>The following are the help messages that will be printed when you invoke any sub-command with <code>--help</code>:</p>
<!--
    The following is injected by the build system

    Looking to improve the help messages? They are located in:

    - src/cli.rs
    - src/command/<subcommand>.rs
-->
<style type="text/css">
.ansi2html-content { display: inline; white-space: pre-wrap; word-wrap: break-word; }
.body_foreground { color: #AAAAAA; }
.body_background { background-color: #000000; }
.inv_foreground { color: #000000; }
.inv_background { background-color: #AAAAAA; }
.ansi1 { font-weight: bold; }
.ansi2 { font-weight: lighter; }
.ansi3 { font-style: italic; }
.ansi4 { text-decoration: underline; }
.ansi5 { text-decoration: blink; }
.ansi6 { text-decoration: blink; }
.ansi8 { visibility: hidden; }
.ansi9 { text-decoration: line-through; }
.ansi30 { color: #000316; }
.inv30 { background-color: #000316; }
.ansi31 { color: #aa0000; }
.inv31 { background-color: #aa0000; }
.ansi32 { color: #00aa00; }
.inv32 { background-color: #00aa00; }
.ansi33 { color: #aa5500; }
.inv33 { background-color: #aa5500; }
.ansi34 { color: #0000aa; }
.inv34 { background-color: #0000aa; }
.ansi35 { color: #E850A8; }
.inv35 { background-color: #E850A8; }
.ansi36 { color: #00aaaa; }
.inv36 { background-color: #00aaaa; }
.ansi37 { color: #F5F1DE; }
.inv37 { background-color: #F5F1DE; }
.ansi40 { background-color: #000316; }
.inv40 { color: #000316; }
.ansi41 { background-color: #aa0000; }
.inv41 { color: #aa0000; }
.ansi42 { background-color: #00aa00; }
.inv42 { color: #00aa00; }
.ansi43 { background-color: #aa5500; }
.inv43 { color: #aa5500; }
.ansi44 { background-color: #0000aa; }
.inv44 { color: #0000aa; }
.ansi45 { background-color: #E850A8; }
.inv45 { color: #E850A8; }
.ansi46 { background-color: #00aaaa; }
.inv46 { color: #00aaaa; }
.ansi47 { background-color: #F5F1DE; }
.inv47 { color: #F5F1DE; }
.ansi90 { color: #7f7f7f; }
.inv90 { background-color: #7f7f7f; }
.ansi91 { color: #ff0000; }
.inv91 { background-color: #ff0000; }
.ansi92 { color: #00ff00; }
.inv92 { background-color: #00ff00; }
.ansi93 { color: #ffff00; }
.inv93 { background-color: #ffff00; }
.ansi94 { color: #5c5cff; }
.inv94 { background-color: #5c5cff; }
.ansi95 { color: #ff00ff; }
.inv95 { background-color: #ff00ff; }
.ansi96 { color: #00ffff; }
.inv96 { background-color: #00ffff; }
.ansi97 { color: #ffffff; }
.inv97 { background-color: #ffffff; }
.ansi100 { background-color: #7f7f7f; }
.inv100 { color: #7f7f7f; }
.ansi101 { background-color: #ff0000; }
.inv101 { color: #ff0000; }
.ansi102 { background-color: #00ff00; }
.inv102 { color: #00ff00; }
.ansi103 { background-color: #ffff00; }
.inv103 { color: #ffff00; }
.ansi104 { background-color: #5c5cff; }
.inv104 { color: #5c5cff; }
.ansi105 { background-color: #ff00ff; }
.inv105 { color: #ff00ff; }
.ansi106 { background-color: #00ffff; }
.inv106 { color: #00ffff; }
.ansi107 { background-color: #ffffff; }
.inv107 { color: #ffffff; }
.ansi38-0 { color: #000316; }
.inv38-0 { background-color: #000316; }
.ansi38-1 { color: #aa0000; }
.inv38-1 { background-color: #aa0000; }
.ansi38-2 { color: #00aa00; }
.inv38-2 { background-color: #00aa00; }
.ansi38-3 { color: #aa5500; }
.inv38-3 { background-color: #aa5500; }
.ansi38-4 { color: #0000aa; }
.inv38-4 { background-color: #0000aa; }
.ansi38-5 { color: #E850A8; }
.inv38-5 { background-color: #E850A8; }
.ansi38-6 { color: #00aaaa; }
.inv38-6 { background-color: #00aaaa; }
.ansi38-7 { color: #F5F1DE; }
.inv38-7 { background-color: #F5F1DE; }
.ansi38-8 { color: #7f7f7f; }
.inv38-8 { background-color: #7f7f7f; }
.ansi38-9 { color: #ff0000; }
.inv38-9 { background-color: #ff0000; }
.ansi38-10 { color: #00ff00; }
.inv38-10 { background-color: #00ff00; }
.ansi38-11 { color: #ffff00; }
.inv38-11 { background-color: #ffff00; }
.ansi38-12 { color: #5c5cff; }
.inv38-12 { background-color: #5c5cff; }
.ansi38-13 { color: #ff00ff; }
.inv38-13 { background-color: #ff00ff; }
.ansi38-14 { color: #00ffff; }
.inv38-14 { background-color: #00ffff; }
.ansi38-15 { color: #ffffff; }
.inv38-15 { background-color: #ffffff; }
.ansi48-0 { background-color: #000316; }
.inv48-0 { color: #000316; }
.ansi48-1 { background-color: #aa0000; }
.inv48-1 { color: #aa0000; }
.ansi48-2 { background-color: #00aa00; }
.inv48-2 { color: #00aa00; }
.ansi48-3 { background-color: #aa5500; }
.inv48-3 { color: #aa5500; }
.ansi48-4 { background-color: #0000aa; }
.inv48-4 { color: #0000aa; }
.ansi48-5 { background-color: #E850A8; }
.inv48-5 { color: #E850A8; }
.ansi48-6 { background-color: #00aaaa; }
.inv48-6 { color: #00aaaa; }
.ansi48-7 { background-color: #F5F1DE; }
.inv48-7 { color: #F5F1DE; }
.ansi48-8 { background-color: #7f7f7f; }
.inv48-8 { color: #7f7f7f; }
.ansi48-9 { background-color: #ff0000; }
.inv48-9 { color: #ff0000; }
.ansi48-10 { background-color: #00ff00; }
.inv48-10 { color: #00ff00; }
.ansi48-11 { background-color: #ffff00; }
.inv48-11 { color: #ffff00; }
.ansi48-12 { background-color: #5c5cff; }
.inv48-12 { color: #5c5cff; }
.ansi48-13 { background-color: #ff00ff; }
.inv48-13 { color: #ff00ff; }
.ansi48-14 { background-color: #00ffff; }
.inv48-14 { color: #00ffff; }
.ansi48-15 { background-color: #ffffff; }
.inv48-15 { color: #ffffff; }
.ansi38-16 { color: #000000; }
.inv38-16 { background: #000000; }
.ansi48-16 { background: #000000; }
.inv48-16 { color: #000000; }
.ansi38-17 { color: #00005f; }
.inv38-17 { background: #00005f; }
.ansi48-17 { background: #00005f; }
.inv48-17 { color: #00005f; }
.ansi38-18 { color: #000087; }
.inv38-18 { background: #000087; }
.ansi48-18 { background: #000087; }
.inv48-18 { color: #000087; }
.ansi38-19 { color: #0000af; }
.inv38-19 { background: #0000af; }
.ansi48-19 { background: #0000af; }
.inv48-19 { color: #0000af; }
.ansi38-20 { color: #0000d7; }
.inv38-20 { background: #0000d7; }
.ansi48-20 { background: #0000d7; }
.inv48-20 { color: #0000d7; }
.ansi38-21 { color: #0000ff; }
.inv38-21 { background: #0000ff; }
.ansi48-21 { background: #0000ff; }
.inv48-21 { color: #0000ff; }
.ansi38-52 { color: #5f0000; }
.inv38-52 { background: #5f0000; }
.ansi48-52 { background: #5f0000; }
.inv48-52 { color: #5f0000; }
.ansi38-53 { color: #5f005f; }
.inv38-53 { background: #5f005f; }
.ansi48-53 { background: #5f005f; }
.inv48-53 { color: #5f005f; }
.ansi38-54 { color: #5f0087; }
.inv38-54 { background: #5f0087; }
.ansi48-54 { background: #5f0087; }
.inv48-54 { color: #5f0087; }
.ansi38-55 { color: #5f00af; }
.inv38-55 { background: #5f00af; }
.ansi48-55 { background: #5f00af; }
.inv48-55 { color: #5f00af; }
.ansi38-56 { color: #5f00d7; }
.inv38-56 { background: #5f00d7; }
.ansi48-56 { background: #5f00d7; }
.inv48-56 { color: #5f00d7; }
.ansi38-57 { color: #5f00ff; }
.inv38-57 { background: #5f00ff; }
.ansi48-57 { background: #5f00ff; }
.inv48-57 { color: #5f00ff; }
.ansi38-88 { color: #870000; }
.inv38-88 { background: #870000; }
.ansi48-88 { background: #870000; }
.inv48-88 { color: #870000; }
.ansi38-89 { color: #87005f; }
.inv38-89 { background: #87005f; }
.ansi48-89 { background: #87005f; }
.inv48-89 { color: #87005f; }
.ansi38-90 { color: #870087; }
.inv38-90 { background: #870087; }
.ansi48-90 { background: #870087; }
.inv48-90 { color: #870087; }
.ansi38-91 { color: #8700af; }
.inv38-91 { background: #8700af; }
.ansi48-91 { background: #8700af; }
.inv48-91 { color: #8700af; }
.ansi38-92 { color: #8700d7; }
.inv38-92 { background: #8700d7; }
.ansi48-92 { background: #8700d7; }
.inv48-92 { color: #8700d7; }
.ansi38-93 { color: #8700ff; }
.inv38-93 { background: #8700ff; }
.ansi48-93 { background: #8700ff; }
.inv48-93 { color: #8700ff; }
.ansi38-124 { color: #af0000; }
.inv38-124 { background: #af0000; }
.ansi48-124 { background: #af0000; }
.inv48-124 { color: #af0000; }
.ansi38-125 { color: #af005f; }
.inv38-125 { background: #af005f; }
.ansi48-125 { background: #af005f; }
.inv48-125 { color: #af005f; }
.ansi38-126 { color: #af0087; }
.inv38-126 { background: #af0087; }
.ansi48-126 { background: #af0087; }
.inv48-126 { color: #af0087; }
.ansi38-127 { color: #af00af; }
.inv38-127 { background: #af00af; }
.ansi48-127 { background: #af00af; }
.inv48-127 { color: #af00af; }
.ansi38-128 { color: #af00d7; }
.inv38-128 { background: #af00d7; }
.ansi48-128 { background: #af00d7; }
.inv48-128 { color: #af00d7; }
.ansi38-129 { color: #af00ff; }
.inv38-129 { background: #af00ff; }
.ansi48-129 { background: #af00ff; }
.inv48-129 { color: #af00ff; }
.ansi38-160 { color: #d70000; }
.inv38-160 { background: #d70000; }
.ansi48-160 { background: #d70000; }
.inv48-160 { color: #d70000; }
.ansi38-161 { color: #d7005f; }
.inv38-161 { background: #d7005f; }
.ansi48-161 { background: #d7005f; }
.inv48-161 { color: #d7005f; }
.ansi38-162 { color: #d70087; }
.inv38-162 { background: #d70087; }
.ansi48-162 { background: #d70087; }
.inv48-162 { color: #d70087; }
.ansi38-163 { color: #d700af; }
.inv38-163 { background: #d700af; }
.ansi48-163 { background: #d700af; }
.inv48-163 { color: #d700af; }
.ansi38-164 { color: #d700d7; }
.inv38-164 { background: #d700d7; }
.ansi48-164 { background: #d700d7; }
.inv48-164 { color: #d700d7; }
.ansi38-165 { color: #d700ff; }
.inv38-165 { background: #d700ff; }
.ansi48-165 { background: #d700ff; }
.inv48-165 { color: #d700ff; }
.ansi38-196 { color: #ff0000; }
.inv38-196 { background: #ff0000; }
.ansi48-196 { background: #ff0000; }
.inv48-196 { color: #ff0000; }
.ansi38-197 { color: #ff005f; }
.inv38-197 { background: #ff005f; }
.ansi48-197 { background: #ff005f; }
.inv48-197 { color: #ff005f; }
.ansi38-198 { color: #ff0087; }
.inv38-198 { background: #ff0087; }
.ansi48-198 { background: #ff0087; }
.inv48-198 { color: #ff0087; }
.ansi38-199 { color: #ff00af; }
.inv38-199 { background: #ff00af; }
.ansi48-199 { background: #ff00af; }
.inv48-199 { color: #ff00af; }
.ansi38-200 { color: #ff00d7; }
.inv38-200 { background: #ff00d7; }
.ansi48-200 { background: #ff00d7; }
.inv48-200 { color: #ff00d7; }
.ansi38-201 { color: #ff00ff; }
.inv38-201 { background: #ff00ff; }
.ansi48-201 { background: #ff00ff; }
.inv48-201 { color: #ff00ff; }
.ansi38-22 { color: #005f00; }
.inv38-22 { background: #005f00; }
.ansi48-22 { background: #005f00; }
.inv48-22 { color: #005f00; }
.ansi38-23 { color: #005f5f; }
.inv38-23 { background: #005f5f; }
.ansi48-23 { background: #005f5f; }
.inv48-23 { color: #005f5f; }
.ansi38-24 { color: #005f87; }
.inv38-24 { background: #005f87; }
.ansi48-24 { background: #005f87; }
.inv48-24 { color: #005f87; }
.ansi38-25 { color: #005faf; }
.inv38-25 { background: #005faf; }
.ansi48-25 { background: #005faf; }
.inv48-25 { color: #005faf; }
.ansi38-26 { color: #005fd7; }
.inv38-26 { background: #005fd7; }
.ansi48-26 { background: #005fd7; }
.inv48-26 { color: #005fd7; }
.ansi38-27 { color: #005fff; }
.inv38-27 { background: #005fff; }
.ansi48-27 { background: #005fff; }
.inv48-27 { color: #005fff; }
.ansi38-58 { color: #5f5f00; }
.inv38-58 { background: #5f5f00; }
.ansi48-58 { background: #5f5f00; }
.inv48-58 { color: #5f5f00; }
.ansi38-59 { color: #5f5f5f; }
.inv38-59 { background: #5f5f5f; }
.ansi48-59 { background: #5f5f5f; }
.inv48-59 { color: #5f5f5f; }
.ansi38-60 { color: #5f5f87; }
.inv38-60 { background: #5f5f87; }
.ansi48-60 { background: #5f5f87; }
.inv48-60 { color: #5f5f87; }
.ansi38-61 { color: #5f5faf; }
.inv38-61 { background: #5f5faf; }
.ansi48-61 { background: #5f5faf; }
.inv48-61 { color: #5f5faf; }
.ansi38-62 { color: #5f5fd7; }
.inv38-62 { background: #5f5fd7; }
.ansi48-62 { background: #5f5fd7; }
.inv48-62 { color: #5f5fd7; }
.ansi38-63 { color: #5f5fff; }
.inv38-63 { background: #5f5fff; }
.ansi48-63 { background: #5f5fff; }
.inv48-63 { color: #5f5fff; }
.ansi38-94 { color: #875f00; }
.inv38-94 { background: #875f00; }
.ansi48-94 { background: #875f00; }
.inv48-94 { color: #875f00; }
.ansi38-95 { color: #875f5f; }
.inv38-95 { background: #875f5f; }
.ansi48-95 { background: #875f5f; }
.inv48-95 { color: #875f5f; }
.ansi38-96 { color: #875f87; }
.inv38-96 { background: #875f87; }
.ansi48-96 { background: #875f87; }
.inv48-96 { color: #875f87; }
.ansi38-97 { color: #875faf; }
.inv38-97 { background: #875faf; }
.ansi48-97 { background: #875faf; }
.inv48-97 { color: #875faf; }
.ansi38-98 { color: #875fd7; }
.inv38-98 { background: #875fd7; }
.ansi48-98 { background: #875fd7; }
.inv48-98 { color: #875fd7; }
.ansi38-99 { color: #875fff; }
.inv38-99 { background: #875fff; }
.ansi48-99 { background: #875fff; }
.inv48-99 { color: #875fff; }
.ansi38-130 { color: #af5f00; }
.inv38-130 { background: #af5f00; }
.ansi48-130 { background: #af5f00; }
.inv48-130 { color: #af5f00; }
.ansi38-131 { color: #af5f5f; }
.inv38-131 { background: #af5f5f; }
.ansi48-131 { background: #af5f5f; }
.inv48-131 { color: #af5f5f; }
.ansi38-132 { color: #af5f87; }
.inv38-132 { background: #af5f87; }
.ansi48-132 { background: #af5f87; }
.inv48-132 { color: #af5f87; }
.ansi38-133 { color: #af5faf; }
.inv38-133 { background: #af5faf; }
.ansi48-133 { background: #af5faf; }
.inv48-133 { color: #af5faf; }
.ansi38-134 { color: #af5fd7; }
.inv38-134 { background: #af5fd7; }
.ansi48-134 { background: #af5fd7; }
.inv48-134 { color: #af5fd7; }
.ansi38-135 { color: #af5fff; }
.inv38-135 { background: #af5fff; }
.ansi48-135 { background: #af5fff; }
.inv48-135 { color: #af5fff; }
.ansi38-166 { color: #d75f00; }
.inv38-166 { background: #d75f00; }
.ansi48-166 { background: #d75f00; }
.inv48-166 { color: #d75f00; }
.ansi38-167 { color: #d75f5f; }
.inv38-167 { background: #d75f5f; }
.ansi48-167 { background: #d75f5f; }
.inv48-167 { color: #d75f5f; }
.ansi38-168 { color: #d75f87; }
.inv38-168 { background: #d75f87; }
.ansi48-168 { background: #d75f87; }
.inv48-168 { color: #d75f87; }
.ansi38-169 { color: #d75faf; }
.inv38-169 { background: #d75faf; }
.ansi48-169 { background: #d75faf; }
.inv48-169 { color: #d75faf; }
.ansi38-170 { color: #d75fd7; }
.inv38-170 { background: #d75fd7; }
.ansi48-170 { background: #d75fd7; }
.inv48-170 { color: #d75fd7; }
.ansi38-171 { color: #d75fff; }
.inv38-171 { background: #d75fff; }
.ansi48-171 { background: #d75fff; }
.inv48-171 { color: #d75fff; }
.ansi38-202 { color: #ff5f00; }
.inv38-202 { background: #ff5f00; }
.ansi48-202 { background: #ff5f00; }
.inv48-202 { color: #ff5f00; }
.ansi38-203 { color: #ff5f5f; }
.inv38-203 { background: #ff5f5f; }
.ansi48-203 { background: #ff5f5f; }
.inv48-203 { color: #ff5f5f; }
.ansi38-204 { color: #ff5f87; }
.inv38-204 { background: #ff5f87; }
.ansi48-204 { background: #ff5f87; }
.inv48-204 { color: #ff5f87; }
.ansi38-205 { color: #ff5faf; }
.inv38-205 { background: #ff5faf; }
.ansi48-205 { background: #ff5faf; }
.inv48-205 { color: #ff5faf; }
.ansi38-206 { color: #ff5fd7; }
.inv38-206 { background: #ff5fd7; }
.ansi48-206 { background: #ff5fd7; }
.inv48-206 { color: #ff5fd7; }
.ansi38-207 { color: #ff5fff; }
.inv38-207 { background: #ff5fff; }
.ansi48-207 { background: #ff5fff; }
.inv48-207 { color: #ff5fff; }
.ansi38-28 { color: #008700; }
.inv38-28 { background: #008700; }
.ansi48-28 { background: #008700; }
.inv48-28 { color: #008700; }
.ansi38-29 { color: #00875f; }
.inv38-29 { background: #00875f; }
.ansi48-29 { background: #00875f; }
.inv48-29 { color: #00875f; }
.ansi38-30 { color: #008787; }
.inv38-30 { background: #008787; }
.ansi48-30 { background: #008787; }
.inv48-30 { color: #008787; }
.ansi38-31 { color: #0087af; }
.inv38-31 { background: #0087af; }
.ansi48-31 { background: #0087af; }
.inv48-31 { color: #0087af; }
.ansi38-32 { color: #0087d7; }
.inv38-32 { background: #0087d7; }
.ansi48-32 { background: #0087d7; }
.inv48-32 { color: #0087d7; }
.ansi38-33 { color: #0087ff; }
.inv38-33 { background: #0087ff; }
.ansi48-33 { background: #0087ff; }
.inv48-33 { color: #0087ff; }
.ansi38-64 { color: #5f8700; }
.inv38-64 { background: #5f8700; }
.ansi48-64 { background: #5f8700; }
.inv48-64 { color: #5f8700; }
.ansi38-65 { color: #5f875f; }
.inv38-65 { background: #5f875f; }
.ansi48-65 { background: #5f875f; }
.inv48-65 { color: #5f875f; }
.ansi38-66 { color: #5f8787; }
.inv38-66 { background: #5f8787; }
.ansi48-66 { background: #5f8787; }
.inv48-66 { color: #5f8787; }
.ansi38-67 { color: #5f87af; }
.inv38-67 { background: #5f87af; }
.ansi48-67 { background: #5f87af; }
.inv48-67 { color: #5f87af; }
.ansi38-68 { color: #5f87d7; }
.inv38-68 { background: #5f87d7; }
.ansi48-68 { background: #5f87d7; }
.inv48-68 { color: #5f87d7; }
.ansi38-69 { color: #5f87ff; }
.inv38-69 { background: #5f87ff; }
.ansi48-69 { background: #5f87ff; }
.inv48-69 { color: #5f87ff; }
.ansi38-100 { color: #878700; }
.inv38-100 { background: #878700; }
.ansi48-100 { background: #878700; }
.inv48-100 { color: #878700; }
.ansi38-101 { color: #87875f; }
.inv38-101 { background: #87875f; }
.ansi48-101 { background: #87875f; }
.inv48-101 { color: #87875f; }
.ansi38-102 { color: #878787; }
.inv38-102 { background: #878787; }
.ansi48-102 { background: #878787; }
.inv48-102 { color: #878787; }
.ansi38-103 { color: #8787af; }
.inv38-103 { background: #8787af; }
.ansi48-103 { background: #8787af; }
.inv48-103 { color: #8787af; }
.ansi38-104 { color: #8787d7; }
.inv38-104 { background: #8787d7; }
.ansi48-104 { background: #8787d7; }
.inv48-104 { color: #8787d7; }
.ansi38-105 { color: #8787ff; }
.inv38-105 { background: #8787ff; }
.ansi48-105 { background: #8787ff; }
.inv48-105 { color: #8787ff; }
.ansi38-136 { color: #af8700; }
.inv38-136 { background: #af8700; }
.ansi48-136 { background: #af8700; }
.inv48-136 { color: #af8700; }
.ansi38-137 { color: #af875f; }
.inv38-137 { background: #af875f; }
.ansi48-137 { background: #af875f; }
.inv48-137 { color: #af875f; }
.ansi38-138 { color: #af8787; }
.inv38-138 { background: #af8787; }
.ansi48-138 { background: #af8787; }
.inv48-138 { color: #af8787; }
.ansi38-139 { color: #af87af; }
.inv38-139 { background: #af87af; }
.ansi48-139 { background: #af87af; }
.inv48-139 { color: #af87af; }
.ansi38-140 { color: #af87d7; }
.inv38-140 { background: #af87d7; }
.ansi48-140 { background: #af87d7; }
.inv48-140 { color: #af87d7; }
.ansi38-141 { color: #af87ff; }
.inv38-141 { background: #af87ff; }
.ansi48-141 { background: #af87ff; }
.inv48-141 { color: #af87ff; }
.ansi38-172 { color: #d78700; }
.inv38-172 { background: #d78700; }
.ansi48-172 { background: #d78700; }
.inv48-172 { color: #d78700; }
.ansi38-173 { color: #d7875f; }
.inv38-173 { background: #d7875f; }
.ansi48-173 { background: #d7875f; }
.inv48-173 { color: #d7875f; }
.ansi38-174 { color: #d78787; }
.inv38-174 { background: #d78787; }
.ansi48-174 { background: #d78787; }
.inv48-174 { color: #d78787; }
.ansi38-175 { color: #d787af; }
.inv38-175 { background: #d787af; }
.ansi48-175 { background: #d787af; }
.inv48-175 { color: #d787af; }
.ansi38-176 { color: #d787d7; }
.inv38-176 { background: #d787d7; }
.ansi48-176 { background: #d787d7; }
.inv48-176 { color: #d787d7; }
.ansi38-177 { color: #d787ff; }
.inv38-177 { background: #d787ff; }
.ansi48-177 { background: #d787ff; }
.inv48-177 { color: #d787ff; }
.ansi38-208 { color: #ff8700; }
.inv38-208 { background: #ff8700; }
.ansi48-208 { background: #ff8700; }
.inv48-208 { color: #ff8700; }
.ansi38-209 { color: #ff875f; }
.inv38-209 { background: #ff875f; }
.ansi48-209 { background: #ff875f; }
.inv48-209 { color: #ff875f; }
.ansi38-210 { color: #ff8787; }
.inv38-210 { background: #ff8787; }
.ansi48-210 { background: #ff8787; }
.inv48-210 { color: #ff8787; }
.ansi38-211 { color: #ff87af; }
.inv38-211 { background: #ff87af; }
.ansi48-211 { background: #ff87af; }
.inv48-211 { color: #ff87af; }
.ansi38-212 { color: #ff87d7; }
.inv38-212 { background: #ff87d7; }
.ansi48-212 { background: #ff87d7; }
.inv48-212 { color: #ff87d7; }
.ansi38-213 { color: #ff87ff; }
.inv38-213 { background: #ff87ff; }
.ansi48-213 { background: #ff87ff; }
.inv48-213 { color: #ff87ff; }
.ansi38-34 { color: #00af00; }
.inv38-34 { background: #00af00; }
.ansi48-34 { background: #00af00; }
.inv48-34 { color: #00af00; }
.ansi38-35 { color: #00af5f; }
.inv38-35 { background: #00af5f; }
.ansi48-35 { background: #00af5f; }
.inv48-35 { color: #00af5f; }
.ansi38-36 { color: #00af87; }
.inv38-36 { background: #00af87; }
.ansi48-36 { background: #00af87; }
.inv48-36 { color: #00af87; }
.ansi38-37 { color: #00afaf; }
.inv38-37 { background: #00afaf; }
.ansi48-37 { background: #00afaf; }
.inv48-37 { color: #00afaf; }
.ansi38-38 { color: #00afd7; }
.inv38-38 { background: #00afd7; }
.ansi48-38 { background: #00afd7; }
.inv48-38 { color: #00afd7; }
.ansi38-39 { color: #00afff; }
.inv38-39 { background: #00afff; }
.ansi48-39 { background: #00afff; }
.inv48-39 { color: #00afff; }
.ansi38-70 { color: #5faf00; }
.inv38-70 { background: #5faf00; }
.ansi48-70 { background: #5faf00; }
.inv48-70 { color: #5faf00; }
.ansi38-71 { color: #5faf5f; }
.inv38-71 { background: #5faf5f; }
.ansi48-71 { background: #5faf5f; }
.inv48-71 { color: #5faf5f; }
.ansi38-72 { color: #5faf87; }
.inv38-72 { background: #5faf87; }
.ansi48-72 { background: #5faf87; }
.inv48-72 { color: #5faf87; }
.ansi38-73 { color: #5fafaf; }
.inv38-73 { background: #5fafaf; }
.ansi48-73 { background: #5fafaf; }
.inv48-73 { color: #5fafaf; }
.ansi38-74 { color: #5fafd7; }
.inv38-74 { background: #5fafd7; }
.ansi48-74 { background: #5fafd7; }
.inv48-74 { color: #5fafd7; }
.ansi38-75 { color: #5fafff; }
.inv38-75 { background: #5fafff; }
.ansi48-75 { background: #5fafff; }
.inv48-75 { color: #5fafff; }
.ansi38-106 { color: #87af00; }
.inv38-106 { background: #87af00; }
.ansi48-106 { background: #87af00; }
.inv48-106 { color: #87af00; }
.ansi38-107 { color: #87af5f; }
.inv38-107 { background: #87af5f; }
.ansi48-107 { background: #87af5f; }
.inv48-107 { color: #87af5f; }
.ansi38-108 { color: #87af87; }
.inv38-108 { background: #87af87; }
.ansi48-108 { background: #87af87; }
.inv48-108 { color: #87af87; }
.ansi38-109 { color: #87afaf; }
.inv38-109 { background: #87afaf; }
.ansi48-109 { background: #87afaf; }
.inv48-109 { color: #87afaf; }
.ansi38-110 { color: #87afd7; }
.inv38-110 { background: #87afd7; }
.ansi48-110 { background: #87afd7; }
.inv48-110 { color: #87afd7; }
.ansi38-111 { color: #87afff; }
.inv38-111 { background: #87afff; }
.ansi48-111 { background: #87afff; }
.inv48-111 { color: #87afff; }
.ansi38-142 { color: #afaf00; }
.inv38-142 { background: #afaf00; }
.ansi48-142 { background: #afaf00; }
.inv48-142 { color: #afaf00; }
.ansi38-143 { color: #afaf5f; }
.inv38-143 { background: #afaf5f; }
.ansi48-143 { background: #afaf5f; }
.inv48-143 { color: #afaf5f; }
.ansi38-144 { color: #afaf87; }
.inv38-144 { background: #afaf87; }
.ansi48-144 { background: #afaf87; }
.inv48-144 { color: #afaf87; }
.ansi38-145 { color: #afafaf; }
.inv38-145 { background: #afafaf; }
.ansi48-145 { background: #afafaf; }
.inv48-145 { color: #afafaf; }
.ansi38-146 { color: #afafd7; }
.inv38-146 { background: #afafd7; }
.ansi48-146 { background: #afafd7; }
.inv48-146 { color: #afafd7; }
.ansi38-147 { color: #afafff; }
.inv38-147 { background: #afafff; }
.ansi48-147 { background: #afafff; }
.inv48-147 { color: #afafff; }
.ansi38-178 { color: #d7af00; }
.inv38-178 { background: #d7af00; }
.ansi48-178 { background: #d7af00; }
.inv48-178 { color: #d7af00; }
.ansi38-179 { color: #d7af5f; }
.inv38-179 { background: #d7af5f; }
.ansi48-179 { background: #d7af5f; }
.inv48-179 { color: #d7af5f; }
.ansi38-180 { color: #d7af87; }
.inv38-180 { background: #d7af87; }
.ansi48-180 { background: #d7af87; }
.inv48-180 { color: #d7af87; }
.ansi38-181 { color: #d7afaf; }
.inv38-181 { background: #d7afaf; }
.ansi48-181 { background: #d7afaf; }
.inv48-181 { color: #d7afaf; }
.ansi38-182 { color: #d7afd7; }
.inv38-182 { background: #d7afd7; }
.ansi48-182 { background: #d7afd7; }
.inv48-182 { color: #d7afd7; }
.ansi38-183 { color: #d7afff; }
.inv38-183 { background: #d7afff; }
.ansi48-183 { background: #d7afff; }
.inv48-183 { color: #d7afff; }
.ansi38-214 { color: #ffaf00; }
.inv38-214 { background: #ffaf00; }
.ansi48-214 { background: #ffaf00; }
.inv48-214 { color: #ffaf00; }
.ansi38-215 { color: #ffaf5f; }
.inv38-215 { background: #ffaf5f; }
.ansi48-215 { background: #ffaf5f; }
.inv48-215 { color: #ffaf5f; }
.ansi38-216 { color: #ffaf87; }
.inv38-216 { background: #ffaf87; }
.ansi48-216 { background: #ffaf87; }
.inv48-216 { color: #ffaf87; }
.ansi38-217 { color: #ffafaf; }
.inv38-217 { background: #ffafaf; }
.ansi48-217 { background: #ffafaf; }
.inv48-217 { color: #ffafaf; }
.ansi38-218 { color: #ffafd7; }
.inv38-218 { background: #ffafd7; }
.ansi48-218 { background: #ffafd7; }
.inv48-218 { color: #ffafd7; }
.ansi38-219 { color: #ffafff; }
.inv38-219 { background: #ffafff; }
.ansi48-219 { background: #ffafff; }
.inv48-219 { color: #ffafff; }
.ansi38-40 { color: #00d700; }
.inv38-40 { background: #00d700; }
.ansi48-40 { background: #00d700; }
.inv48-40 { color: #00d700; }
.ansi38-41 { color: #00d75f; }
.inv38-41 { background: #00d75f; }
.ansi48-41 { background: #00d75f; }
.inv48-41 { color: #00d75f; }
.ansi38-42 { color: #00d787; }
.inv38-42 { background: #00d787; }
.ansi48-42 { background: #00d787; }
.inv48-42 { color: #00d787; }
.ansi38-43 { color: #00d7af; }
.inv38-43 { background: #00d7af; }
.ansi48-43 { background: #00d7af; }
.inv48-43 { color: #00d7af; }
.ansi38-44 { color: #00d7d7; }
.inv38-44 { background: #00d7d7; }
.ansi48-44 { background: #00d7d7; }
.inv48-44 { color: #00d7d7; }
.ansi38-45 { color: #00d7ff; }
.inv38-45 { background: #00d7ff; }
.ansi48-45 { background: #00d7ff; }
.inv48-45 { color: #00d7ff; }
.ansi38-76 { color: #5fd700; }
.inv38-76 { background: #5fd700; }
.ansi48-76 { background: #5fd700; }
.inv48-76 { color: #5fd700; }
.ansi38-77 { color: #5fd75f; }
.inv38-77 { background: #5fd75f; }
.ansi48-77 { background: #5fd75f; }
.inv48-77 { color: #5fd75f; }
.ansi38-78 { color: #5fd787; }
.inv38-78 { background: #5fd787; }
.ansi48-78 { background: #5fd787; }
.inv48-78 { color: #5fd787; }
.ansi38-79 { color: #5fd7af; }
.inv38-79 { background: #5fd7af; }
.ansi48-79 { background: #5fd7af; }
.inv48-79 { color: #5fd7af; }
.ansi38-80 { color: #5fd7d7; }
.inv38-80 { background: #5fd7d7; }
.ansi48-80 { background: #5fd7d7; }
.inv48-80 { color: #5fd7d7; }
.ansi38-81 { color: #5fd7ff; }
.inv38-81 { background: #5fd7ff; }
.ansi48-81 { background: #5fd7ff; }
.inv48-81 { color: #5fd7ff; }
.ansi38-112 { color: #87d700; }
.inv38-112 { background: #87d700; }
.ansi48-112 { background: #87d700; }
.inv48-112 { color: #87d700; }
.ansi38-113 { color: #87d75f; }
.inv38-113 { background: #87d75f; }
.ansi48-113 { background: #87d75f; }
.inv48-113 { color: #87d75f; }
.ansi38-114 { color: #87d787; }
.inv38-114 { background: #87d787; }
.ansi48-114 { background: #87d787; }
.inv48-114 { color: #87d787; }
.ansi38-115 { color: #87d7af; }
.inv38-115 { background: #87d7af; }
.ansi48-115 { background: #87d7af; }
.inv48-115 { color: #87d7af; }
.ansi38-116 { color: #87d7d7; }
.inv38-116 { background: #87d7d7; }
.ansi48-116 { background: #87d7d7; }
.inv48-116 { color: #87d7d7; }
.ansi38-117 { color: #87d7ff; }
.inv38-117 { background: #87d7ff; }
.ansi48-117 { background: #87d7ff; }
.inv48-117 { color: #87d7ff; }
.ansi38-148 { color: #afd700; }
.inv38-148 { background: #afd700; }
.ansi48-148 { background: #afd700; }
.inv48-148 { color: #afd700; }
.ansi38-149 { color: #afd75f; }
.inv38-149 { background: #afd75f; }
.ansi48-149 { background: #afd75f; }
.inv48-149 { color: #afd75f; }
.ansi38-150 { color: #afd787; }
.inv38-150 { background: #afd787; }
.ansi48-150 { background: #afd787; }
.inv48-150 { color: #afd787; }
.ansi38-151 { color: #afd7af; }
.inv38-151 { background: #afd7af; }
.ansi48-151 { background: #afd7af; }
.inv48-151 { color: #afd7af; }
.ansi38-152 { color: #afd7d7; }
.inv38-152 { background: #afd7d7; }
.ansi48-152 { background: #afd7d7; }
.inv48-152 { color: #afd7d7; }
.ansi38-153 { color: #afd7ff; }
.inv38-153 { background: #afd7ff; }
.ansi48-153 { background: #afd7ff; }
.inv48-153 { color: #afd7ff; }
.ansi38-184 { color: #d7d700; }
.inv38-184 { background: #d7d700; }
.ansi48-184 { background: #d7d700; }
.inv48-184 { color: #d7d700; }
.ansi38-185 { color: #d7d75f; }
.inv38-185 { background: #d7d75f; }
.ansi48-185 { background: #d7d75f; }
.inv48-185 { color: #d7d75f; }
.ansi38-186 { color: #d7d787; }
.inv38-186 { background: #d7d787; }
.ansi48-186 { background: #d7d787; }
.inv48-186 { color: #d7d787; }
.ansi38-187 { color: #d7d7af; }
.inv38-187 { background: #d7d7af; }
.ansi48-187 { background: #d7d7af; }
.inv48-187 { color: #d7d7af; }
.ansi38-188 { color: #d7d7d7; }
.inv38-188 { background: #d7d7d7; }
.ansi48-188 { background: #d7d7d7; }
.inv48-188 { color: #d7d7d7; }
.ansi38-189 { color: #d7d7ff; }
.inv38-189 { background: #d7d7ff; }
.ansi48-189 { background: #d7d7ff; }
.inv48-189 { color: #d7d7ff; }
.ansi38-220 { color: #ffd700; }
.inv38-220 { background: #ffd700; }
.ansi48-220 { background: #ffd700; }
.inv48-220 { color: #ffd700; }
.ansi38-221 { color: #ffd75f; }
.inv38-221 { background: #ffd75f; }
.ansi48-221 { background: #ffd75f; }
.inv48-221 { color: #ffd75f; }
.ansi38-222 { color: #ffd787; }
.inv38-222 { background: #ffd787; }
.ansi48-222 { background: #ffd787; }
.inv48-222 { color: #ffd787; }
.ansi38-223 { color: #ffd7af; }
.inv38-223 { background: #ffd7af; }
.ansi48-223 { background: #ffd7af; }
.inv48-223 { color: #ffd7af; }
.ansi38-224 { color: #ffd7d7; }
.inv38-224 { background: #ffd7d7; }
.ansi48-224 { background: #ffd7d7; }
.inv48-224 { color: #ffd7d7; }
.ansi38-225 { color: #ffd7ff; }
.inv38-225 { background: #ffd7ff; }
.ansi48-225 { background: #ffd7ff; }
.inv48-225 { color: #ffd7ff; }
.ansi38-46 { color: #00ff00; }
.inv38-46 { background: #00ff00; }
.ansi48-46 { background: #00ff00; }
.inv48-46 { color: #00ff00; }
.ansi38-47 { color: #00ff5f; }
.inv38-47 { background: #00ff5f; }
.ansi48-47 { background: #00ff5f; }
.inv48-47 { color: #00ff5f; }
.ansi38-48 { color: #00ff87; }
.inv38-48 { background: #00ff87; }
.ansi48-48 { background: #00ff87; }
.inv48-48 { color: #00ff87; }
.ansi38-49 { color: #00ffaf; }
.inv38-49 { background: #00ffaf; }
.ansi48-49 { background: #00ffaf; }
.inv48-49 { color: #00ffaf; }
.ansi38-50 { color: #00ffd7; }
.inv38-50 { background: #00ffd7; }
.ansi48-50 { background: #00ffd7; }
.inv48-50 { color: #00ffd7; }
.ansi38-51 { color: #00ffff; }
.inv38-51 { background: #00ffff; }
.ansi48-51 { background: #00ffff; }
.inv48-51 { color: #00ffff; }
.ansi38-82 { color: #5fff00; }
.inv38-82 { background: #5fff00; }
.ansi48-82 { background: #5fff00; }
.inv48-82 { color: #5fff00; }
.ansi38-83 { color: #5fff5f; }
.inv38-83 { background: #5fff5f; }
.ansi48-83 { background: #5fff5f; }
.inv48-83 { color: #5fff5f; }
.ansi38-84 { color: #5fff87; }
.inv38-84 { background: #5fff87; }
.ansi48-84 { background: #5fff87; }
.inv48-84 { color: #5fff87; }
.ansi38-85 { color: #5fffaf; }
.inv38-85 { background: #5fffaf; }
.ansi48-85 { background: #5fffaf; }
.inv48-85 { color: #5fffaf; }
.ansi38-86 { color: #5fffd7; }
.inv38-86 { background: #5fffd7; }
.ansi48-86 { background: #5fffd7; }
.inv48-86 { color: #5fffd7; }
.ansi38-87 { color: #5fffff; }
.inv38-87 { background: #5fffff; }
.ansi48-87 { background: #5fffff; }
.inv48-87 { color: #5fffff; }
.ansi38-118 { color: #87ff00; }
.inv38-118 { background: #87ff00; }
.ansi48-118 { background: #87ff00; }
.inv48-118 { color: #87ff00; }
.ansi38-119 { color: #87ff5f; }
.inv38-119 { background: #87ff5f; }
.ansi48-119 { background: #87ff5f; }
.inv48-119 { color: #87ff5f; }
.ansi38-120 { color: #87ff87; }
.inv38-120 { background: #87ff87; }
.ansi48-120 { background: #87ff87; }
.inv48-120 { color: #87ff87; }
.ansi38-121 { color: #87ffaf; }
.inv38-121 { background: #87ffaf; }
.ansi48-121 { background: #87ffaf; }
.inv48-121 { color: #87ffaf; }
.ansi38-122 { color: #87ffd7; }
.inv38-122 { background: #87ffd7; }
.ansi48-122 { background: #87ffd7; }
.inv48-122 { color: #87ffd7; }
.ansi38-123 { color: #87ffff; }
.inv38-123 { background: #87ffff; }
.ansi48-123 { background: #87ffff; }
.inv48-123 { color: #87ffff; }
.ansi38-154 { color: #afff00; }
.inv38-154 { background: #afff00; }
.ansi48-154 { background: #afff00; }
.inv48-154 { color: #afff00; }
.ansi38-155 { color: #afff5f; }
.inv38-155 { background: #afff5f; }
.ansi48-155 { background: #afff5f; }
.inv48-155 { color: #afff5f; }
.ansi38-156 { color: #afff87; }
.inv38-156 { background: #afff87; }
.ansi48-156 { background: #afff87; }
.inv48-156 { color: #afff87; }
.ansi38-157 { color: #afffaf; }
.inv38-157 { background: #afffaf; }
.ansi48-157 { background: #afffaf; }
.inv48-157 { color: #afffaf; }
.ansi38-158 { color: #afffd7; }
.inv38-158 { background: #afffd7; }
.ansi48-158 { background: #afffd7; }
.inv48-158 { color: #afffd7; }
.ansi38-159 { color: #afffff; }
.inv38-159 { background: #afffff; }
.ansi48-159 { background: #afffff; }
.inv48-159 { color: #afffff; }
.ansi38-190 { color: #d7ff00; }
.inv38-190 { background: #d7ff00; }
.ansi48-190 { background: #d7ff00; }
.inv48-190 { color: #d7ff00; }
.ansi38-191 { color: #d7ff5f; }
.inv38-191 { background: #d7ff5f; }
.ansi48-191 { background: #d7ff5f; }
.inv48-191 { color: #d7ff5f; }
.ansi38-192 { color: #d7ff87; }
.inv38-192 { background: #d7ff87; }
.ansi48-192 { background: #d7ff87; }
.inv48-192 { color: #d7ff87; }
.ansi38-193 { color: #d7ffaf; }
.inv38-193 { background: #d7ffaf; }
.ansi48-193 { background: #d7ffaf; }
.inv48-193 { color: #d7ffaf; }
.ansi38-194 { color: #d7ffd7; }
.inv38-194 { background: #d7ffd7; }
.ansi48-194 { background: #d7ffd7; }
.inv48-194 { color: #d7ffd7; }
.ansi38-195 { color: #d7ffff; }
.inv38-195 { background: #d7ffff; }
.ansi48-195 { background: #d7ffff; }
.inv48-195 { color: #d7ffff; }
.ansi38-226 { color: #ffff00; }
.inv38-226 { background: #ffff00; }
.ansi48-226 { background: #ffff00; }
.inv48-226 { color: #ffff00; }
.ansi38-227 { color: #ffff5f; }
.inv38-227 { background: #ffff5f; }
.ansi48-227 { background: #ffff5f; }
.inv48-227 { color: #ffff5f; }
.ansi38-228 { color: #ffff87; }
.inv38-228 { background: #ffff87; }
.ansi48-228 { background: #ffff87; }
.inv48-228 { color: #ffff87; }
.ansi38-229 { color: #ffffaf; }
.inv38-229 { background: #ffffaf; }
.ansi48-229 { background: #ffffaf; }
.inv48-229 { color: #ffffaf; }
.ansi38-230 { color: #ffffd7; }
.inv38-230 { background: #ffffd7; }
.ansi48-230 { background: #ffffd7; }
.inv48-230 { color: #ffffd7; }
.ansi38-231 { color: #ffffff; }
.inv38-231 { background: #ffffff; }
.ansi48-231 { background: #ffffff; }
.inv48-231 { color: #ffffff; }
.ansi38-232 { color: #080808; }
.inv38-232 { background: #080808; }
.ansi48-232 { background: #080808; }
.inv48-232 { color: #080808; }
.ansi38-233 { color: #121212; }
.inv38-233 { background: #121212; }
.ansi48-233 { background: #121212; }
.inv48-233 { color: #121212; }
.ansi38-234 { color: #1c1c1c; }
.inv38-234 { background: #1c1c1c; }
.ansi48-234 { background: #1c1c1c; }
.inv48-234 { color: #1c1c1c; }
.ansi38-235 { color: #262626; }
.inv38-235 { background: #262626; }
.ansi48-235 { background: #262626; }
.inv48-235 { color: #262626; }
.ansi38-236 { color: #303030; }
.inv38-236 { background: #303030; }
.ansi48-236 { background: #303030; }
.inv48-236 { color: #303030; }
.ansi38-237 { color: #3a3a3a; }
.inv38-237 { background: #3a3a3a; }
.ansi48-237 { background: #3a3a3a; }
.inv48-237 { color: #3a3a3a; }
.ansi38-238 { color: #444444; }
.inv38-238 { background: #444444; }
.ansi48-238 { background: #444444; }
.inv48-238 { color: #444444; }
.ansi38-239 { color: #4e4e4e; }
.inv38-239 { background: #4e4e4e; }
.ansi48-239 { background: #4e4e4e; }
.inv48-239 { color: #4e4e4e; }
.ansi38-240 { color: #585858; }
.inv38-240 { background: #585858; }
.ansi48-240 { background: #585858; }
.inv48-240 { color: #585858; }
.ansi38-241 { color: #626262; }
.inv38-241 { background: #626262; }
.ansi48-241 { background: #626262; }
.inv48-241 { color: #626262; }
.ansi38-242 { color: #6c6c6c; }
.inv38-242 { background: #6c6c6c; }
.ansi48-242 { background: #6c6c6c; }
.inv48-242 { color: #6c6c6c; }
.ansi38-243 { color: #767676; }
.inv38-243 { background: #767676; }
.ansi48-243 { background: #767676; }
.inv48-243 { color: #767676; }
.ansi38-244 { color: #808080; }
.inv38-244 { background: #808080; }
.ansi48-244 { background: #808080; }
.inv48-244 { color: #808080; }
.ansi38-245 { color: #8a8a8a; }
.inv38-245 { background: #8a8a8a; }
.ansi48-245 { background: #8a8a8a; }
.inv48-245 { color: #8a8a8a; }
.ansi38-246 { color: #949494; }
.inv38-246 { background: #949494; }
.ansi48-246 { background: #949494; }
.inv48-246 { color: #949494; }
.ansi38-247 { color: #9e9e9e; }
.inv38-247 { background: #9e9e9e; }
.ansi48-247 { background: #9e9e9e; }
.inv48-247 { color: #9e9e9e; }
.ansi38-248 { color: #a8a8a8; }
.inv38-248 { background: #a8a8a8; }
.ansi48-248 { background: #a8a8a8; }
.inv48-248 { color: #a8a8a8; }
.ansi38-249 { color: #b2b2b2; }
.inv38-249 { background: #b2b2b2; }
.ansi48-249 { background: #b2b2b2; }
.inv48-249 { color: #b2b2b2; }
.ansi38-250 { color: #bcbcbc; }
.inv38-250 { background: #bcbcbc; }
.ansi48-250 { background: #bcbcbc; }
.inv48-250 { color: #bcbcbc; }
.ansi38-251 { color: #c6c6c6; }
.inv38-251 { background: #c6c6c6; }
.ansi48-251 { background: #c6c6c6; }
.inv48-251 { color: #c6c6c6; }
.ansi38-252 { color: #d0d0d0; }
.inv38-252 { background: #d0d0d0; }
.ansi48-252 { background: #d0d0d0; }
.inv48-252 { color: #d0d0d0; }
.ansi38-253 { color: #dadada; }
.inv38-253 { background: #dadada; }
.ansi48-253 { background: #dadada; }
.inv48-253 { color: #dadada; }
.ansi38-254 { color: #e4e4e4; }
.inv38-254 { background: #e4e4e4; }
.ansi48-254 { background: #e4e4e4; }
.inv48-254 { color: #e4e4e4; }
.ansi38-255 { color: #eeeeee; }
.inv38-255 { background: #eeeeee; }
.ansi48-255 { background: #eeeeee; }
.inv48-255 { color: #eeeeee; }
</style>
<h2 id="colmena"><a class="header" href="#colmena"><code>colmena</code></a></h2>
<pre><div class="hljs">NixOS deployment tool

Colmena helps you deploy to multiple hosts running NixOS.
For more details, read the manual at &lt;https://colmena.cli.rs/0.5&gt;.


Note: You are using a pre-release version of Colmena, so the supported options may be different from what's in the manual.

<span class="ansi1"></span><span class="ansi1 ansi4">Usage:</span> <span class="ansi1">colmena</span> [OPTIONS] &lt;COMMAND&gt;

<span class="ansi1"></span><span class="ansi1 ansi4">Commands:</span>
  <span class="ansi1">apply</span>        Apply configurations on remote machines
  <span class="ansi1">apply-local</span>  Apply configurations on the local machine
  <span class="ansi1">build</span>        Build configurations but not push to remote machines
  <span class="ansi1">eval</span>         Evaluate an expression using the complete configuration
  <span class="ansi1">upload-keys</span>  Upload keys to remote hosts
  <span class="ansi1">exec</span>         Run a command on remote machines
  <span class="ansi1">repl</span>         Start an interactive REPL with the complete configuration
  <span class="ansi1">nix-info</span>     Show information about the current Nix installation
  <span class="ansi1">help</span>         Print this message or the help of the given subcommand(s)

<span class="ansi1"></span><span class="ansi1 ansi4">Options:</span>
      <span class="ansi1">--show-trace</span>
          Passes --show-trace to Nix commands

      <span class="ansi1">--impure</span>
          Passes --impure to Nix commands

      <span class="ansi1">--nix-option</span> &lt;NAME&gt; &lt;VALUE&gt;
          Passes arbitrary options to Nix commands
          
          This only works when building locally.
          

  <span class="ansi1">-f</span>, <span class="ansi1">--config</span> &lt;CONFIG&gt;
          If this argument is not specified, Colmena will search upwards from the current working directory for a file named "flake.nix" or "hive.nix". This behavior is disabled if --config/-f is given explicitly.
          
          For a sample configuration, check the manual at &lt;https://colmena.cli.rs/0.5&gt;.
          

  <span class="ansi1">-h</span>, <span class="ansi1">--help</span>
          Print help (see a summary with '-h')

  <span class="ansi1">-V</span>, <span class="ansi1">--version</span>
          Print version

      <span class="ansi1">--color</span> &lt;WHEN&gt;
          When to colorize the output. By default, Colmena enables colorized output when the terminal supports it.
          
          It's also possible to specify the preference using environment variables. See &lt;https://bixense.com/clicolors&gt;.
          
          
          [default: auto]

          Possible values:
          - <span class="ansi1">auto</span>:   Detect automatically
          - <span class="ansi1">always</span>: Always display colors
          - <span class="ansi1">never</span>:  Never display colors
</div></pre>
<h2 id="colmena-apply"><a class="header" href="#colmena-apply"><code>colmena apply</code></a></h2>
<pre><div class="hljs">Apply configurations on remote machines

<span class="ansi1"></span><span class="ansi1 ansi4">Usage:</span> <span class="ansi1">colmena apply</span> [OPTIONS] [GOAL]

<span class="ansi1"></span><span class="ansi1 ansi4">Arguments:</span>
  [GOAL]
          The goal of the deployment.
          
          Same as the targets for switch-to-configuration, with the following extra pseudo-goals:
          
          - build: Only build the system profiles
          - push: Only copy the closures to remote nodes
          - keys: Only upload the keys to the remote nodes
          
          `switch` is the default goal unless `--reboot` is passed, in which case `boot` is the default.
          
          
          [default: switch]

          Possible values:
          - <span class="ansi1">build</span>:        Build the configurations only
          - <span class="ansi1">push</span>:         Push the closures only
          - <span class="ansi1">switch</span>:       Make the configuration the boot default and activate now
          - <span class="ansi1">boot</span>:         Make the configuration the boot default
          - <span class="ansi1">test</span>:         Activate the configuration, but don't make it the boot default
          - <span class="ansi1">dry-activate</span>: Show what would be done if this configuration were activated
          - <span class="ansi1">upload-keys</span>:  Only upload keys

<span class="ansi1"></span><span class="ansi1 ansi4">Options:</span>
      <span class="ansi1">--eval-node-limit</span> &lt;LIMIT&gt;
          Limits the maximum number of hosts to be evaluated at once.
          
          The evaluation process is RAM-intensive. The default behavior is to limit the maximum number of host evaluated at the same time based on naive heuristics.
          
          Set to 0 to disable the limit.
          
          
          [default: auto]

  <span class="ansi1">-p</span>, <span class="ansi1">--parallel</span> &lt;LIMIT&gt;
          Limits the maximum number of hosts to be deployed in parallel.
          
          Set to 0 to disable parallelism limit.
          
          
          [default: 10]

      <span class="ansi1">--show-trace</span>
          Passes --show-trace to Nix commands

      <span class="ansi1">--impure</span>
          Passes --impure to Nix commands

      <span class="ansi1">--keep-result</span>
          Create GC roots for built profiles.
          
          The built system profiles will be added as GC roots so that they will not be removed by the garbage collector.
          The links will be created under .gcroots in the directory the Hive configuration is located.
          

      <span class="ansi1">--nix-option</span> &lt;NAME&gt; &lt;VALUE&gt;
          Passes arbitrary options to Nix commands
          
          This only works when building locally.
          

  <span class="ansi1">-v</span>, <span class="ansi1">--verbose</span>
          Deactivates the progress spinner and prints every line of output.

      <span class="ansi1">--no-keys</span>
          Do not upload secret keys set in `deployment.keys`.
          
          By default, Colmena will upload keys set in `deployment.keys` before deploying the new profile on a node.
          To upload keys without building or deploying the rest of the configuration, use `colmena upload-keys`.
          

      <span class="ansi1">--reboot</span>
          Reboots nodes after activation and waits for them to come back up.

      <span class="ansi1">--no-substitute</span>
          Disables the use of substituters when copying closures to the remote host.

      <span class="ansi1">--no-gzip</span>
          Disables the use of gzip when copying closures to the remote host.

      <span class="ansi1">--build-on-target</span>
          Build the system profiles on the target nodes themselves.
          
          If enabled, the system profiles will be built on the target nodes themselves, not on the host running Colmena itself.
          This overrides per-node perferences set in `deployment.buildOnTarget`.
          To temporarily disable remote build on all nodes, use `--no-build-on-target`.
          

      <span class="ansi1">--force-replace-unknown-profiles</span>
          If `deployment.replaceUnknownProfiles` is set for a target, using this switch
          will treat deployment.replaceUnknownProfiles as though it was set true and perform unknown profile replacement.

      <span class="ansi1">--evaluator</span> &lt;EVALUATOR&gt;
          If set to `chunked` (default), evaluation of nodes will happen in batches. If set to `streaming`, the experimental streaming evaluator (nix-eval-jobs) will be used and nodes will be evaluated in parallel.
          
          This is an experimental feature.
          
          [default: chunked]
          [possible values: chunked, streaming]

      <span class="ansi1">--on</span> &lt;NODES&gt;
          Select a list of nodes to deploy to.
          
          The list is comma-separated and globs are supported. To match tags, prepend the filter by @. Valid examples:
          
          - host1,host2,host3
          - edge-*
          - edge-*,core-*
          - @a-tag,@tags-can-have-*

  <span class="ansi1">-f</span>, <span class="ansi1">--config</span> &lt;CONFIG&gt;
          If this argument is not specified, Colmena will search upwards from the current working directory for a file named "flake.nix" or "hive.nix". This behavior is disabled if --config/-f is given explicitly.
          
          For a sample configuration, check the manual at &lt;https://colmena.cli.rs/0.5&gt;.
          

  <span class="ansi1">-h</span>, <span class="ansi1">--help</span>
          Print help (see a summary with '-h')

      <span class="ansi1">--color</span> &lt;WHEN&gt;
          When to colorize the output. By default, Colmena enables colorized output when the terminal supports it.
          
          It's also possible to specify the preference using environment variables. See &lt;https://bixense.com/clicolors&gt;.
          
          
          [default: auto]

          Possible values:
          - <span class="ansi1">auto</span>:   Detect automatically
          - <span class="ansi1">always</span>: Always display colors
          - <span class="ansi1">never</span>:  Never display colors
</div></pre>
<h2 id="colmena-apply-local"><a class="header" href="#colmena-apply-local"><code>colmena apply-local</code></a></h2>
<pre><div class="hljs">Apply configurations on the local machine

<span class="ansi1"></span><span class="ansi1 ansi4">Usage:</span> <span class="ansi1">colmena apply-local</span> [OPTIONS] [GOAL]

<span class="ansi1"></span><span class="ansi1 ansi4">Arguments:</span>
  [GOAL]
          Same as the targets for switch-to-configuration.
          "push" is noop in apply-local.
          
          [default: switch]

          Possible values:
          - <span class="ansi1">build</span>:        Build the configurations only
          - <span class="ansi1">push</span>:         Push the closures only
          - <span class="ansi1">switch</span>:       Make the configuration the boot default and activate now
          - <span class="ansi1">boot</span>:         Make the configuration the boot default
          - <span class="ansi1">test</span>:         Activate the configuration, but don't make it the boot default
          - <span class="ansi1">dry-activate</span>: Show what would be done if this configuration were activated
          - <span class="ansi1">upload-keys</span>:  Only upload keys

<span class="ansi1"></span><span class="ansi1 ansi4">Options:</span>
      <span class="ansi1">--sudo</span>
          Attempt to escalate privileges if not run as root

      <span class="ansi1">--show-trace</span>
          Passes --show-trace to Nix commands

  <span class="ansi1">-v</span>, <span class="ansi1">--verbose</span>
          Deactivates the progress spinner and prints every line of output.

      <span class="ansi1">--impure</span>
          Passes --impure to Nix commands

      <span class="ansi1">--no-keys</span>
          Do not deploy secret keys set in `deployment.keys`.
          
          By default, Colmena will deploy keys set in `deployment.keys` before activating the profile on this host.
          

      <span class="ansi1">--nix-option</span> &lt;NAME&gt; &lt;VALUE&gt;
          Passes arbitrary options to Nix commands
          
          This only works when building locally.
          

      <span class="ansi1">--node</span> &lt;NODE&gt;
          Override the node name to use

  <span class="ansi1">-f</span>, <span class="ansi1">--config</span> &lt;CONFIG&gt;
          If this argument is not specified, Colmena will search upwards from the current working directory for a file named "flake.nix" or "hive.nix". This behavior is disabled if --config/-f is given explicitly.
          
          For a sample configuration, check the manual at &lt;https://colmena.cli.rs/0.5&gt;.
          

  <span class="ansi1">-h</span>, <span class="ansi1">--help</span>
          Print help (see a summary with '-h')

      <span class="ansi1">--color</span> &lt;WHEN&gt;
          When to colorize the output. By default, Colmena enables colorized output when the terminal supports it.
          
          It's also possible to specify the preference using environment variables. See &lt;https://bixense.com/clicolors&gt;.
          
          
          [default: auto]

          Possible values:
          - <span class="ansi1">auto</span>:   Detect automatically
          - <span class="ansi1">always</span>: Always display colors
          - <span class="ansi1">never</span>:  Never display colors
</div></pre>
<h2 id="colmena-build"><a class="header" href="#colmena-build"><code>colmena build</code></a></h2>
<pre><div class="hljs">Build configurations but not push to remote machines

This subcommand behaves as if you invoked `apply` with the `build` goal.

<span class="ansi1"></span><span class="ansi1 ansi4">Usage:</span> <span class="ansi1">colmena build</span> [OPTIONS]

<span class="ansi1"></span><span class="ansi1 ansi4">Options:</span>
      <span class="ansi1">--eval-node-limit</span> &lt;LIMIT&gt;
          Limits the maximum number of hosts to be evaluated at once.
          
          The evaluation process is RAM-intensive. The default behavior is to limit the maximum number of host evaluated at the same time based on naive heuristics.
          
          Set to 0 to disable the limit.
          
          
          [default: auto]

  <span class="ansi1">-p</span>, <span class="ansi1">--parallel</span> &lt;LIMIT&gt;
          Limits the maximum number of hosts to be deployed in parallel.
          
          Set to 0 to disable parallelism limit.
          
          
          [default: 10]

      <span class="ansi1">--show-trace</span>
          Passes --show-trace to Nix commands

      <span class="ansi1">--impure</span>
          Passes --impure to Nix commands

      <span class="ansi1">--keep-result</span>
          Create GC roots for built profiles.
          
          The built system profiles will be added as GC roots so that they will not be removed by the garbage collector.
          The links will be created under .gcroots in the directory the Hive configuration is located.
          

      <span class="ansi1">--nix-option</span> &lt;NAME&gt; &lt;VALUE&gt;
          Passes arbitrary options to Nix commands
          
          This only works when building locally.
          

  <span class="ansi1">-v</span>, <span class="ansi1">--verbose</span>
          Deactivates the progress spinner and prints every line of output.

      <span class="ansi1">--no-keys</span>
          Do not upload secret keys set in `deployment.keys`.
          
          By default, Colmena will upload keys set in `deployment.keys` before deploying the new profile on a node.
          To upload keys without building or deploying the rest of the configuration, use `colmena upload-keys`.
          

      <span class="ansi1">--reboot</span>
          Reboots nodes after activation and waits for them to come back up.

      <span class="ansi1">--no-substitute</span>
          Disables the use of substituters when copying closures to the remote host.

      <span class="ansi1">--no-gzip</span>
          Disables the use of gzip when copying closures to the remote host.

      <span class="ansi1">--build-on-target</span>
          Build the system profiles on the target nodes themselves.
          
          If enabled, the system profiles will be built on the target nodes themselves, not on the host running Colmena itself.
          This overrides per-node perferences set in `deployment.buildOnTarget`.
          To temporarily disable remote build on all nodes, use `--no-build-on-target`.
          

      <span class="ansi1">--force-replace-unknown-profiles</span>
          If `deployment.replaceUnknownProfiles` is set for a target, using this switch
          will treat deployment.replaceUnknownProfiles as though it was set true and perform unknown profile replacement.

      <span class="ansi1">--evaluator</span> &lt;EVALUATOR&gt;
          If set to `chunked` (default), evaluation of nodes will happen in batches. If set to `streaming`, the experimental streaming evaluator (nix-eval-jobs) will be used and nodes will be evaluated in parallel.
          
          This is an experimental feature.
          
          [default: chunked]
          [possible values: chunked, streaming]

      <span class="ansi1">--on</span> &lt;NODES&gt;
          Select a list of nodes to deploy to.
          
          The list is comma-separated and globs are supported. To match tags, prepend the filter by @. Valid examples:
          
          - host1,host2,host3
          - edge-*
          - edge-*,core-*
          - @a-tag,@tags-can-have-*

  <span class="ansi1">-f</span>, <span class="ansi1">--config</span> &lt;CONFIG&gt;
          If this argument is not specified, Colmena will search upwards from the current working directory for a file named "flake.nix" or "hive.nix". This behavior is disabled if --config/-f is given explicitly.
          
          For a sample configuration, check the manual at &lt;https://colmena.cli.rs/0.5&gt;.
          

  <span class="ansi1">-h</span>, <span class="ansi1">--help</span>
          Print help (see a summary with '-h')

      <span class="ansi1">--color</span> &lt;WHEN&gt;
          When to colorize the output. By default, Colmena enables colorized output when the terminal supports it.
          
          It's also possible to specify the preference using environment variables. See &lt;https://bixense.com/clicolors&gt;.
          
          
          [default: auto]

          Possible values:
          - <span class="ansi1">auto</span>:   Detect automatically
          - <span class="ansi1">always</span>: Always display colors
          - <span class="ansi1">never</span>:  Never display colors
</div></pre>
<h2 id="colmena-upload-keys"><a class="header" href="#colmena-upload-keys"><code>colmena upload-keys</code></a></h2>
<pre><div class="hljs">Upload keys to remote hosts

This subcommand behaves as if you invoked `apply` with the pseudo `keys` goal.

<span class="ansi1"></span><span class="ansi1 ansi4">Usage:</span> <span class="ansi1">colmena upload-keys</span> [OPTIONS]

<span class="ansi1"></span><span class="ansi1 ansi4">Options:</span>
      <span class="ansi1">--eval-node-limit</span> &lt;LIMIT&gt;
          Limits the maximum number of hosts to be evaluated at once.
          
          The evaluation process is RAM-intensive. The default behavior is to limit the maximum number of host evaluated at the same time based on naive heuristics.
          
          Set to 0 to disable the limit.
          
          
          [default: auto]

  <span class="ansi1">-p</span>, <span class="ansi1">--parallel</span> &lt;LIMIT&gt;
          Limits the maximum number of hosts to be deployed in parallel.
          
          Set to 0 to disable parallelism limit.
          
          
          [default: 10]

      <span class="ansi1">--show-trace</span>
          Passes --show-trace to Nix commands

      <span class="ansi1">--impure</span>
          Passes --impure to Nix commands

      <span class="ansi1">--keep-result</span>
          Create GC roots for built profiles.
          
          The built system profiles will be added as GC roots so that they will not be removed by the garbage collector.
          The links will be created under .gcroots in the directory the Hive configuration is located.
          

      <span class="ansi1">--nix-option</span> &lt;NAME&gt; &lt;VALUE&gt;
          Passes arbitrary options to Nix commands
          
          This only works when building locally.
          

  <span class="ansi1">-v</span>, <span class="ansi1">--verbose</span>
          Deactivates the progress spinner and prints every line of output.

      <span class="ansi1">--no-keys</span>
          Do not upload secret keys set in `deployment.keys`.
          
          By default, Colmena will upload keys set in `deployment.keys` before deploying the new profile on a node.
          To upload keys without building or deploying the rest of the configuration, use `colmena upload-keys`.
          

      <span class="ansi1">--reboot</span>
          Reboots nodes after activation and waits for them to come back up.

      <span class="ansi1">--no-substitute</span>
          Disables the use of substituters when copying closures to the remote host.

      <span class="ansi1">--no-gzip</span>
          Disables the use of gzip when copying closures to the remote host.

      <span class="ansi1">--build-on-target</span>
          Build the system profiles on the target nodes themselves.
          
          If enabled, the system profiles will be built on the target nodes themselves, not on the host running Colmena itself.
          This overrides per-node perferences set in `deployment.buildOnTarget`.
          To temporarily disable remote build on all nodes, use `--no-build-on-target`.
          

      <span class="ansi1">--force-replace-unknown-profiles</span>
          If `deployment.replaceUnknownProfiles` is set for a target, using this switch
          will treat deployment.replaceUnknownProfiles as though it was set true and perform unknown profile replacement.

      <span class="ansi1">--evaluator</span> &lt;EVALUATOR&gt;
          If set to `chunked` (default), evaluation of nodes will happen in batches. If set to `streaming`, the experimental streaming evaluator (nix-eval-jobs) will be used and nodes will be evaluated in parallel.
          
          This is an experimental feature.
          
          [default: chunked]
          [possible values: chunked, streaming]

      <span class="ansi1">--on</span> &lt;NODES&gt;
          Select a list of nodes to deploy to.
          
          The list is comma-separated and globs are supported. To match tags, prepend the filter by @. Valid examples:
          
          - host1,host2,host3
          - edge-*
          - edge-*,core-*
          - @a-tag,@tags-can-have-*

  <span class="ansi1">-f</span>, <span class="ansi1">--config</span> &lt;CONFIG&gt;
          If this argument is not specified, Colmena will search upwards from the current working directory for a file named "flake.nix" or "hive.nix". This behavior is disabled if --config/-f is given explicitly.
          
          For a sample configuration, check the manual at &lt;https://colmena.cli.rs/0.5&gt;.
          

  <span class="ansi1">-h</span>, <span class="ansi1">--help</span>
          Print help (see a summary with '-h')

      <span class="ansi1">--color</span> &lt;WHEN&gt;
          When to colorize the output. By default, Colmena enables colorized output when the terminal supports it.
          
          It's also possible to specify the preference using environment variables. See &lt;https://bixense.com/clicolors&gt;.
          
          
          [default: auto]

          Possible values:
          - <span class="ansi1">auto</span>:   Detect automatically
          - <span class="ansi1">always</span>: Always display colors
          - <span class="ansi1">never</span>:  Never display colors
</div></pre>
<h2 id="colmena-eval"><a class="header" href="#colmena-eval"><code>colmena eval</code></a></h2>
<pre><div class="hljs">Evaluate an expression using the complete configuration

Your expression should take an attribute set with keys `pkgs`, `lib` and `nodes` (like a NixOS module) and return a JSON-serializable value.

For example, to retrieve the configuration of one node, you may write something like:

    { nodes, ... }: nodes.node-a.config.networking.hostName


<span class="ansi1"></span><span class="ansi1 ansi4">Usage:</span> <span class="ansi1">colmena eval</span> [OPTIONS] [FILE]

<span class="ansi1"></span><span class="ansi1 ansi4">Arguments:</span>
  [FILE]
          The .nix file containing the expression

<span class="ansi1"></span><span class="ansi1 ansi4">Options:</span>
  <span class="ansi1">-E</span> &lt;EXPRESSION&gt;
          The Nix expression

      <span class="ansi1">--instantiate</span>
          Actually instantiate the expression

      <span class="ansi1">--show-trace</span>
          Passes --show-trace to Nix commands

      <span class="ansi1">--impure</span>
          Passes --impure to Nix commands

      <span class="ansi1">--nix-option</span> &lt;NAME&gt; &lt;VALUE&gt;
          Passes arbitrary options to Nix commands
          
          This only works when building locally.
          

  <span class="ansi1">-f</span>, <span class="ansi1">--config</span> &lt;CONFIG&gt;
          If this argument is not specified, Colmena will search upwards from the current working directory for a file named "flake.nix" or "hive.nix". This behavior is disabled if --config/-f is given explicitly.
          
          For a sample configuration, check the manual at &lt;https://colmena.cli.rs/0.5&gt;.
          

  <span class="ansi1">-h</span>, <span class="ansi1">--help</span>
          Print help (see a summary with '-h')

      <span class="ansi1">--color</span> &lt;WHEN&gt;
          When to colorize the output. By default, Colmena enables colorized output when the terminal supports it.
          
          It's also possible to specify the preference using environment variables. See &lt;https://bixense.com/clicolors&gt;.
          
          
          [default: auto]

          Possible values:
          - <span class="ansi1">auto</span>:   Detect automatically
          - <span class="ansi1">always</span>: Always display colors
          - <span class="ansi1">never</span>:  Never display colors
</div></pre>
<h2 id="colmena-exec"><a class="header" href="#colmena-exec"><code>colmena exec</code></a></h2>
<pre><div class="hljs">Run a command on remote machines

<span class="ansi1"></span><span class="ansi1 ansi4">Usage:</span> <span class="ansi1">colmena exec</span> [OPTIONS] &lt;COMMAND&gt;...

<span class="ansi1"></span><span class="ansi1 ansi4">Arguments:</span>
  &lt;COMMAND&gt;...
          Command to run
          
          It's recommended to use -- to separate Colmena options from the command to run. For example:
          
              colmena exec --on @routers -- tcpdump -vni any ip[9] == 89
          

<span class="ansi1"></span><span class="ansi1 ansi4">Options:</span>
  <span class="ansi1">-p</span>, <span class="ansi1">--parallel</span> &lt;LIMIT&gt;
          Limits the maximum number of hosts to run the command in parallel.
          
          In `colmena exec`, the parallelism limit is disabled (0) by default.
          
          
          [default: 0]

      <span class="ansi1">--show-trace</span>
          Passes --show-trace to Nix commands

  <span class="ansi1">-v</span>, <span class="ansi1">--verbose</span>
          Deactivates the progress spinner and prints every line of output.

      <span class="ansi1">--impure</span>
          Passes --impure to Nix commands

      <span class="ansi1">--on</span> &lt;NODES&gt;
          Select a list of nodes to deploy to.
          
          The list is comma-separated and globs are supported. To match tags, prepend the filter by @. Valid examples:
          
          - host1,host2,host3
          - edge-*
          - edge-*,core-*
          - @a-tag,@tags-can-have-*

      <span class="ansi1">--nix-option</span> &lt;NAME&gt; &lt;VALUE&gt;
          Passes arbitrary options to Nix commands
          
          This only works when building locally.
          

  <span class="ansi1">-f</span>, <span class="ansi1">--config</span> &lt;CONFIG&gt;
          If this argument is not specified, Colmena will search upwards from the current working directory for a file named "flake.nix" or "hive.nix". This behavior is disabled if --config/-f is given explicitly.
          
          For a sample configuration, check the manual at &lt;https://colmena.cli.rs/0.5&gt;.
          

  <span class="ansi1">-h</span>, <span class="ansi1">--help</span>
          Print help (see a summary with '-h')

      <span class="ansi1">--color</span> &lt;WHEN&gt;
          When to colorize the output. By default, Colmena enables colorized output when the terminal supports it.
          
          It's also possible to specify the preference using environment variables. See &lt;https://bixense.com/clicolors&gt;.
          
          
          [default: auto]

          Possible values:
          - <span class="ansi1">auto</span>:   Detect automatically
          - <span class="ansi1">always</span>: Always display colors
          - <span class="ansi1">never</span>:  Never display colors
</div></pre>
<h2 id="colmena-nix-info"><a class="header" href="#colmena-nix-info"><code>colmena nix-info</code></a></h2>
<pre><div class="hljs">Show information about the current Nix installation

<span class="ansi1"></span><span class="ansi1 ansi4">Usage:</span> <span class="ansi1">colmena nix-info</span> [OPTIONS]

<span class="ansi1"></span><span class="ansi1 ansi4">Options:</span>
      <span class="ansi1">--show-trace</span>
          Passes --show-trace to Nix commands

      <span class="ansi1">--impure</span>
          Passes --impure to Nix commands

      <span class="ansi1">--nix-option</span> &lt;NAME&gt; &lt;VALUE&gt;
          Passes arbitrary options to Nix commands
          
          This only works when building locally.
          

  <span class="ansi1">-f</span>, <span class="ansi1">--config</span> &lt;CONFIG&gt;
          If this argument is not specified, Colmena will search upwards from the current working directory for a file named "flake.nix" or "hive.nix". This behavior is disabled if --config/-f is given explicitly.
          
          For a sample configuration, check the manual at &lt;https://colmena.cli.rs/0.5&gt;.
          

  <span class="ansi1">-h</span>, <span class="ansi1">--help</span>
          Print help (see a summary with '-h')

      <span class="ansi1">--color</span> &lt;WHEN&gt;
          When to colorize the output. By default, Colmena enables colorized output when the terminal supports it.
          
          It's also possible to specify the preference using environment variables. See &lt;https://bixense.com/clicolors&gt;.
          
          
          [default: auto]

          Possible values:
          - <span class="ansi1">auto</span>:   Detect automatically
          - <span class="ansi1">always</span>: Always display colors
          - <span class="ansi1">never</span>:  Never display colors
</div></pre>
<h2 id="colmena-repl"><a class="header" href="#colmena-repl"><code>colmena repl</code></a></h2>
<pre><div class="hljs">Start an interactive REPL with the complete configuration

In the REPL, you can inspect the configuration interactively with tab
completion. The node configurations are accessible under the `nodes`
attribute set.

<span class="ansi1"></span><span class="ansi1 ansi4">Usage:</span> <span class="ansi1">colmena repl</span> [OPTIONS]

<span class="ansi1"></span><span class="ansi1 ansi4">Options:</span>
      <span class="ansi1">--show-trace</span>
          Passes --show-trace to Nix commands

      <span class="ansi1">--impure</span>
          Passes --impure to Nix commands

      <span class="ansi1">--nix-option</span> &lt;NAME&gt; &lt;VALUE&gt;
          Passes arbitrary options to Nix commands
          
          This only works when building locally.
          

  <span class="ansi1">-f</span>, <span class="ansi1">--config</span> &lt;CONFIG&gt;
          If this argument is not specified, Colmena will search upwards from the current working directory for a file named "flake.nix" or "hive.nix". This behavior is disabled if --config/-f is given explicitly.
          
          For a sample configuration, check the manual at &lt;https://colmena.cli.rs/0.5&gt;.
          

  <span class="ansi1">-h</span>, <span class="ansi1">--help</span>
          Print help (see a summary with '-h')

      <span class="ansi1">--color</span> &lt;WHEN&gt;
          When to colorize the output. By default, Colmena enables colorized output when the terminal supports it.
          
          It's also possible to specify the preference using environment variables. See &lt;https://bixense.com/clicolors&gt;.
          
          
          [default: auto]

          Possible values:
          - <span class="ansi1">auto</span>:   Detect automatically
          - <span class="ansi1">always</span>: Always display colors
          - <span class="ansi1">never</span>:  Never display colors
</div></pre>
<div style="break-before: page; page-break-before: always;"></div><!-- Generated from version 0.5.0-pre (apiVersion=0.5, unstable=True) -->
<h1 id="release-notes"><a class="header" href="#release-notes">Release Notes</a></h1>
<h2 id="release-040-20230514"><a class="header" href="#release-040-20230514"><a href="https://github.com/zhaofengli/colmena/releases/tag/v0.4.0">Release 0.4.0</a> (2023/05/14)</a></h2>
<ul>
<li>Flake evaluation is now actually pure by default. To enable impure expressions, pass <code>--impure</code>.</li>
<li><code>--reboot</code> is added to trigger a reboot and wait for the node to come back up.</li>
<li>The target user is no longer explicitly set when <code>deployment.targetUser</code> is null (<a href="https://github.com/zhaofengli/colmena/pull/91">#91</a>).</li>
<li>In <code>apply-local</code>, we now only escalate privileges during activation (<a href="https://github.com/zhaofengli/colmena/issues/85">#85</a>).</li>
<li>Impure overlays are no longer imported by default if a path is specified in <code>meta.nixpkgs</code> (<a href="https://github.com/zhaofengli/colmena/issues/39">#39</a>)</li>
<li>GC roots are now created right after the builds are complete, as opposed to after activation.</li>
<li>The <a href="./reference/meta.html#allowapplyall"><code>meta.allowApplyAll</code></a> option has been added. If set to false, deployments without a node filter (<code>--on</code>) are disallowed (<a href="https://github.com/zhaofengli/colmena/issues/95">#95</a>).</li>
<li>The <code>--no-substitutes</code> option under the <code>apply</code> subcommand has been renamed to <code>--no-substitute</code> (<a href="https://github.com/zhaofengli/colmena/issues/59">#59</a>).</li>
<li>The <a href="./reference/meta.html#nodespecialargs"><code>meta.nodeSpecialArgs</code></a> option has been added. It allows specifying node-specific <code>specialArgs</code> passed to NixOS modules (<a href="https://github.com/zhaofengli/colmena/pull/100">#100</a>).</li>
<li>The <a href="./reference/cli.html#colmena-repl"><code>repl</code></a> subcommand has been added. It allows you to start an <a href="./features/eval.html#interactive-repl">interactive REPL</a> with access to the complete node configurations.</li>
<li>The default goal for <code>colmena apply</code> is now <code>boot</code> if <code>--reboot</code> is specified, and <code>switch</code> otherwise (<a href="https://github.com/zhaofengli/colmena/issues/113">#113</a>).</li>
<li>Post-activation keys are now uploaded after the reboot if <code>--reboot</code> is specified (<a href="https://github.com/zhaofengli/colmena/issues/113">#113</a>).</li>
<li>Flake-enabled deployments now use the new SSH store protocol (<code>ssh-ng://</code>).</li>
</ul>
<h2 id="release-032-20220929"><a class="header" href="#release-032-20220929"><a href="https://github.com/zhaofengli/colmena/releases/tag/v0.3.1">Release 0.3.2</a> (2022/09/29)</a></h2>
<ul>
<li>Fixed: <a href="https://colmena.cli.rs/0.3/features/keys.html#key-services">Key services</a> were using the deprecated <code>inotifyTools</code> alias removed from <code>nixos-unstable</code> (<a href="https://github.com/NixOS/nixpkgs/pull/192681">NixOS/nixpkgs#192681</a>).</li>
</ul>
<h2 id="release-031-20220818"><a class="header" href="#release-031-20220818"><a href="https://github.com/zhaofengli/colmena/releases/tag/v0.3.1">Release 0.3.1</a> (2022/08/18)</a></h2>
<ul>
<li>Fixed: Streaming evaluation fails for node names containing periods (<a href="https://github.com/zhaofengli/colmena/issues/92">#92</a>)</li>
<li>Fixed: Streaming evaluation fails in non-flake deployments with relative paths (<a href="https://github.com/zhaofengli/colmena/issues/107">#107</a>)</li>
<li>Fixed: <code>colmena apply-local</code> returning non-zero exit code when successful (<a href="https://github.com/zhaofengli/colmena/issues/111">#111</a>)</li>
</ul>
<h2 id="release-030-20220427"><a class="header" href="#release-030-20220427"><a href="https://github.com/zhaofengli/colmena/releases/tag/v0.3.0">Release 0.3.0</a> (2022/04/27)</a></h2>
<ul>
<li><a href="https://colmena.cli.rs/0.3/features/remote-builds.html">Remote builds</a> are now supported (<a href="https://github.com/zhaofengli/colmena/issues/33">#33</a>).</li>
<li><a href="https://colmena.cli.rs/0.3/features/parallelism.html#parallel-evaluation-experimental">Streaming evaluation</a> powered by <a href="https://github.com/nix-community/nix-eval-jobs">nix-eval-jobs</a> is now available as an experimental feature (<code>--evaluator streaming</code>).</li>
<li>Colmena can now run on macOS to deploy to NixOS hosts using <a href="https://colmena.cli.rs/0.3/features/remote-builds.html">remote building</a>.</li>
<li>It's now possible to configure output colorization via the CLI and environment variables. Colmena follows the <a href="https://bixense.com/clicolors">clicolors</a> standard.</li>
<li><a href="https://colmena.cli.rs/0.3/features/keys.html#key-services">A systemd unit</a> (<code>${name}-key.service</code>) is now created for each secret file deployed using <code>deployment.keys</code> (<a href="https://github.com/zhaofengli/colmena/issues/48">#48</a>).</li>
<li>Node enumeration is now faster if you do not filter against tags with <code>--on @tag-name</code>.</li>
<li>The main deployment logic has been rewritten to be cleaner and easier to follow.</li>
<li>There are now <a href="https://github.com/zhaofengli/colmena/tree/main/integration-tests">end-to-end tests</a> to ensure that the development branch is actually functional as a whole at all times.</li>
</ul>
<h2 id="release-022-20220308"><a class="header" href="#release-022-20220308"><a href="https://github.com/zhaofengli/colmena/releases/tag/v0.2.2">Release 0.2.2</a> (2022/03/08)</a></h2>
<p>This bugfix release fixes NixOS detection so <code>apply-local</code> works with the latest changes in <code>nixos-unstable</code> (<a href="https://github.com/zhaofengli/colmena/pull/63">#63</a>). Additionally, <code>--no-keys</code> was fixed in <code>apply-local</code>.</p>
<h2 id="release-021-20220126"><a class="header" href="#release-021-20220126"><a href="https://github.com/zhaofengli/colmena/releases/tag/v0.2.1">Release 0.2.1</a> (2022/01/26)</a></h2>
<p>This bugfix release fixes the issue (<a href="https://github.com/zhaofengli/colmena/issues/50">#50</a>) where <a href="https://github.com/NixOS/nixpkgs/pull/149532">sandboxed documentation builds</a> fail when using the unstable Nixpkgs channel.</p>
<h2 id="release-020-20211118"><a class="header" href="#release-020-20211118"><a href="https://github.com/zhaofengli/colmena/releases/tag/v0.2.0">Release 0.2.0</a> (2021/11/18)</a></h2>
<p>This is release 0.2.0, the first stable release of Colmena!</p>
<p>Colmena is a simple, stateless NixOS deployment tool modeled after NixOps and morph, built from the ground up to support parallel deployments.</p>
<p>This release contains the following features:</p>
<ul>
<li>Node Tagging</li>
<li>Local Deployment</li>
<li>Secrets</li>
<li>Ad Hoc Evaluation</li>
<li>Nix Flakes Support</li>
<li>Parallelism</li>
</ul>
<p>We now have a User Manual at https://colmena.cli.rs/0.2 containing tutorials, sample configurations as well as a complete listing of supported deployment options.</p>
<div style="break-before: page; page-break-before: always;"></div><!-- Generated from version 0.5.0-pre (apiVersion=0.5, unstable=True) -->
<h1 id="contributing"><a class="header" href="#contributing">Contributing</a></h1>
<p>Contributions are welcome!</p>
<h2 id="code"><a class="header" href="#code">Code</a></h2>
<p>You can checkout the source code and submit pull requests at <a href="https://github.com/zhaofengli/colmena">the GitHub repo</a>.</p>
<p>By contributing code to Colmena, you agree that your contributions will be available under <a href="https://github.com/zhaofengli/colmena/blob/main/LICENSE">the MIT License</a>.</p>
<h2 id="issues--feature-requests"><a class="header" href="#issues--feature-requests">Issues &amp; Feature Requests</a></h2>
<p>Bumped into a problem? We would like to fix it!
Please open a new issue at <a href="https://github.com/zhaofengli/colmena">the GitHub repo</a>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
